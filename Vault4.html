<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SecureVault - Offline Password Manager">
    <title>SecureVault - Password Manager</title>
	<meta name="application-name" content="SecureVault">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="SecureVault">
<meta name="mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#3469ab">
<link rel="manifest" href="#" id="manifestLink">
<link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%233469ab' width='100' height='100' rx='20'/><text x='50' y='68' text-anchor='middle' fill='white' font-size='50' font-family='Arial'>üîê</text></svg>">
    <style>
        /* ========================================
           CSS VARIABLES - LIGHT/DARK THEMES
        ======================================== */
        :root {
            /* Light Mode Colors */
            --bg-primary: #f5f7fa;
            --bg-secondary: #ffffff;
            --bg-tertiary: #e8ecf0;
            --bg-hover: #f0f4f8;
            --text-primary: #1a1a2e;
            --text-secondary: #4a5568;
            --text-muted: #718096;
            --border-color: #e2e8f0;
            --border-light: #f0f0f0;
            
            /* Accent Colors */
            --accent-primary: #3469ab;
            --accent-hover: #2c5a94;
            --accent-active: #245085;
            --accent-light: rgba(52, 105, 171, 0.1);
            --accent-lighter: rgba(52, 105, 171, 0.05);
            
            /* Status Colors */
            --danger: #dc3545;
            --danger-hover: #c82333;
            --danger-light: rgba(220, 53, 69, 0.1);
            --success: #28a745;
            --success-light: rgba(40, 167, 69, 0.1);
            --warning: #ffc107;
            --warning-light: rgba(255, 193, 7, 0.1);
            --info: #17a2b8;
            
            /* Shadows */
            --shadow-xs: 0 1px 2px rgba(0,0,0,0.05);
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.1);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 25px rgba(0,0,0,0.15);
            --shadow-xl: 0 20px 40px rgba(0,0,0,0.2);
            
            /* Border Radius */
            --radius-xs: 4px;
            --radius-sm: 6px;
            --radius-md: 10px;
            --radius-lg: 16px;
            --radius-xl: 24px;
            --radius-full: 50%;
            
            /* Transitions */
            --transition-fast: all 0.15s ease;
            --transition: all 0.2s ease;
            --transition-slow: all 0.3s ease;
            
            /* Spacing */
            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;
            --space-2xl: 48px;
            
            /* Sidebar */
            --sidebar-width: 280px;
            --sidebar-collapsed: 70px;
            
            /* Category Colors */
            --cat-social: #e91e63;
            --cat-banking: #4caf50;
            --cat-email: #2196f3;
            --cat-work: #ff9800;
            --cat-shopping: #9c27b0;
            --cat-travel: #00bcd4;
            --cat-entertainment: #f44336;
            --cat-health: #8bc34a;
            --cat-education: #3f51b5;
            --cat-other: #607d8b;
        }

        [data-theme="dark"] {
            --bg-primary: #0d0d14;
            --bg-secondary: #151521;
            --bg-tertiary: #1e1e2e;
            --bg-hover: #252538;
            --text-primary: #e8eaf0;
            --text-secondary: #a8b0c0;
            --text-muted: #6b7280;
            --border-color: #2a2a40;
            --border-light: #202030;
            
            --accent-light: rgba(52, 105, 171, 0.2);
            --accent-lighter: rgba(52, 105, 171, 0.1);
            
            --danger-light: rgba(220, 53, 69, 0.15);
            --success-light: rgba(40, 167, 69, 0.15);
            --warning-light: rgba(255, 193, 7, 0.15);
            
            --shadow-xs: 0 1px 2px rgba(0,0,0,0.2);
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.3);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.4);
            --shadow-lg: 0 10px 25px rgba(0,0,0,0.5);
            --shadow-xl: 0 20px 40px rgba(0,0,0,0.6);
        }

        /* ========================================
           RESET & BASE STYLES
        ======================================== */
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: 16px;
            -webkit-text-size-adjust: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 
                         'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        a {
            color: var(--accent-primary);
            text-decoration: none;
            transition: var(--transition-fast);
        }

        a:hover {
            color: var(--accent-hover);
        }

        button {
            font-family: inherit;
            cursor: pointer;
            border: none;
            background: none;
            font-size: inherit;
        }

        input, textarea, select {
            font-family: inherit;
            font-size: inherit;
        }

        img, svg {
            display: block;
            max-width: 100%;
        }

        ul, ol {
            list-style: none;
        }

        /* ========================================
           UTILITY CLASSES
        ======================================== */
        .hidden {
            display: none !important;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            border: 0;
        }

        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .text-muted { color: var(--text-muted); }
        .text-danger { color: var(--danger); }
        .text-success { color: var(--success); }

        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-center { justify-content: center; }
        .justify-between { justify-content: space-between; }
        .gap-sm { gap: var(--space-sm); }
        .gap-md { gap: var(--space-md); }

        /* ========================================
           SCROLLBAR STYLING
        ======================================== */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
            border-radius: var(--radius-full);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: var(--radius-full);
            transition: var(--transition);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }

        /* ========================================
           LOCK SCREEN STYLES
        ======================================== */
        .lock-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            padding: var(--space-md);
        }

        .lock-container {
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            padding: var(--space-2xl);
            width: 100%;
            max-width: 420px;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .lock-logo {
            width: 80px;
            height: 80px;
            margin: 0 auto var(--space-lg);
            background: var(--accent-light);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent-primary);
        }

        .lock-logo svg {
            width: 44px;
            height: 44px;
        }

        .lock-title {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: var(--space-xs);
            color: var(--text-primary);
        }

        .lock-subtitle {
            color: var(--text-muted);
            margin-bottom: var(--space-xl);
            font-size: 0.95rem;
        }

        .lock-form {
            display: flex;
            flex-direction: column;
            gap: var(--space-md);
        }

        .password-input-wrapper {
            position: relative;
            width: 100%;
        }

        .password-input-wrapper input {
            width: 100%;
            padding: 14px 50px 14px 16px;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-md);
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 1rem;
            transition: var(--transition);
        }

        .password-input-wrapper input:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px var(--accent-light);
        }

        .password-input-wrapper input::placeholder {
            color: var(--text-muted);
        }

        .password-toggle {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition-fast);
        }

        .password-toggle:hover {
            color: var(--text-primary);
        }

        .password-toggle svg {
            width: 22px;
            height: 22px;
        }

        .lock-error {
            color: var(--danger);
            font-size: 0.875rem;
            min-height: 20px;
            margin-top: -4px;
        }

        .lock-btn {
            background: var(--accent-primary);
            color: white;
            border: none;
            padding: 14px 24px;
            border-radius: var(--radius-md);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
        }

        .lock-btn:hover {
            background: var(--accent-hover);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .lock-btn:active {
            transform: translateY(0);
        }

        .lock-btn svg {
            width: 20px;
            height: 20px;
        }

        .lock-footer {
            margin-top: var(--space-xl);
            padding-top: var(--space-lg);
            border-top: 1px solid var(--border-color);
        }

        .lock-footer-text {
            color: var(--text-muted);
            font-size: 0.875rem;
            margin-bottom: var(--space-md);
        }

        .lock-actions {
            display: flex;
            gap: var(--space-sm);
            justify-content: center;
            flex-wrap: wrap;
        }

        .lock-action-btn {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
            padding: 10px 16px;
            border-radius: var(--radius-sm);
            font-size: 0.875rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }

        .lock-action-btn:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
            border-color: var(--accent-primary);
        }

        .lock-action-btn svg {
            width: 16px;
            height: 16px;
        }

        /* ========================================
           SETUP WIZARD STYLES
        ======================================== */
        .setup-wizard {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: var(--bg-primary);
    display: flex;
    align-items: flex-start;
    justify-content: center;
    z-index: 10000;
    padding: var(--space-lg) var(--space-md);
    overflow-y: auto;
}

        .setup-container {
    background: var(--bg-secondary);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-xl);
    padding: var(--space-2xl);
    width: 100%;
    max-width: 500px;
    border: 1px solid var(--border-color);
    margin: auto;
}

        .setup-header {
            text-align: center;
            margin-bottom: var(--space-xl);
        }

        .setup-step {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            margin-bottom: var(--space-md);
        }

        .setup-step-dot {
            width: 10px;
            height: 10px;
            border-radius: var(--radius-full);
            background: var(--border-color);
            transition: var(--transition);
        }

        .setup-step-dot.active {
            background: var(--accent-primary);
            width: 24px;
        }

        .setup-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: var(--space-xs);
        }

        .setup-description {
            color: var(--text-muted);
            font-size: 0.95rem;
        }

        .setup-form {
            display: flex;
            flex-direction: column;
            gap: var(--space-lg);
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: var(--space-xs);
        }

        .form-label {
            font-weight: 600;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-md);
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px var(--accent-light);
        }

        .form-hint {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .password-strength {
            display: flex;
            gap: 4px;
            margin-top: var(--space-xs);
        }

        .strength-bar {
            flex: 1;
            height: 4px;
            background: var(--border-color);
            border-radius: var(--radius-full);
            transition: var(--transition);
        }

        .strength-bar.weak { background: var(--danger); }
        .strength-bar.fair { background: var(--warning); }
        .strength-bar.good { background: var(--info); }
        .strength-bar.strong { background: var(--success); }

        .strength-text {
            font-size: 0.75rem;
            margin-top: var(--space-xs);
        }

        .setup-actions {
            display: flex;
            gap: var(--space-md);
            margin-top: var(--space-lg);
        }

        .setup-btn {
            flex: 1;
            padding: 14px 24px;
            border-radius: var(--radius-md);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
        }

        .setup-btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
        }

        .setup-btn-secondary:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .setup-btn-primary {
            background: var(--accent-primary);
            color: white;
            border: none;
        }

        .setup-btn-primary:hover {
            background: var(--accent-hover);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .setup-btn svg {
            width: 18px;
            height: 18px;
        }

        .setup-or {
            text-align: center;
            color: var(--text-muted);
            font-size: 0.875rem;
            margin: var(--space-lg) 0;
            position: relative;
        }

        .setup-or::before,
        .setup-or::after {
            content: '';
            position: absolute;
            top: 50%;
            width: calc(50% - 20px);
            height: 1px;
            background: var(--border-color);
        }

        .setup-or::before { left: 0; }
        .setup-or::after { right: 0; }

        .import-area {
            border: 2px dashed var(--border-color);
            border-radius: var(--radius-md);
            padding: var(--space-xl);
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
        }

        .import-area:hover {
            border-color: var(--accent-primary);
            background: var(--accent-lighter);
        }

        .import-area svg {
            width: 48px;
            height: 48px;
            color: var(--text-muted);
            margin: 0 auto var(--space-md);
        }

        .import-area-title {
            font-weight: 600;
            margin-bottom: var(--space-xs);
        }

        .import-area-text {
            color: var(--text-muted);
            font-size: 0.875rem;
        }

        /* ========================================
           MAIN APP LAYOUT
        ======================================== */
        .app-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            position: fixed;
            top: 0;
            left: 0;
            bottom: 0;
            z-index: 100;
            transition: var(--transition-slow);
        }

        .sidebar-header {
            padding: var(--space-lg);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }

        .sidebar-logo {
            width: 40px;
            height: 40px;
            background: var(--accent-light);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent-primary);
            flex-shrink: 0;
        }

        .sidebar-logo svg {
            width: 24px;
            height: 24px;
        }

        .sidebar-brand {
            flex: 1;
            min-width: 0;
        }

        .sidebar-brand-name {
            font-size: 1.125rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .sidebar-brand-tagline {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .sidebar-nav {
            flex: 1;
            overflow-y: auto;
            padding: var(--space-md);
        }

        .nav-section {
            margin-bottom: var(--space-lg);
        }

        .nav-section-title {
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-muted);
            padding: var(--space-sm) var(--space-md);
            margin-bottom: var(--space-xs);
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            padding: 10px var(--space-md);
            border-radius: var(--radius-sm);
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition-fast);
            margin-bottom: 2px;
        }

        .nav-item:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .nav-item.active {
            background: var(--accent-light);
            color: var(--accent-primary);
        }

        .nav-item svg {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
        }

        .nav-item-text {
            flex: 1;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .nav-item-count {
            background: var(--bg-tertiary);
            color: var(--text-muted);
            font-size: 0.75rem;
            font-weight: 600;
            padding: 2px 8px;
            border-radius: var(--radius-full);
        }

        .nav-item.active .nav-item-count {
            background: var(--accent-primary);
            color: white;
        }

        .category-dot {
            width: 10px;
            height: 10px;
            border-radius: var(--radius-full);
            flex-shrink: 0;
        }

        .sidebar-footer {
            padding: var(--space-md);
            border-top: 1px solid var(--border-color);
        }

        .sidebar-footer-btn {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            width: 100%;
            padding: 10px var(--space-md);
            border-radius: var(--radius-sm);
            color: var(--text-secondary);
            background: none;
            border: none;
            cursor: pointer;
            transition: var(--transition-fast);
            font-size: 0.9rem;
        }

        .sidebar-footer-btn:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .sidebar-footer-btn.danger:hover {
            background: var(--danger-light);
            color: var(--danger);
        }

        .sidebar-footer-btn svg {
            width: 20px;
            height: 20px;
        }

        /* ========================================
           MAIN CONTENT AREA
        ======================================== */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* Top Header */
        .main-header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            padding: var(--space-md) var(--space-lg);
            display: flex;
            align-items: center;
            gap: var(--space-md);
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: var(--text-secondary);
            padding: var(--space-sm);
            cursor: pointer;
            border-radius: var(--radius-sm);
        }

        .mobile-menu-btn:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .mobile-menu-btn svg {
            width: 24px;
            height: 24px;
        }

        .search-wrapper {
            flex: 1;
            max-width: 500px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 10px 16px 10px 44px;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-md);
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 0.95rem;
            transition: var(--transition);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px var(--accent-light);
        }

        .search-input::placeholder {
            color: var(--text-muted);
        }

        .search-icon {
            position: absolute;
            left: 14px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            width: 20px;
            height: 20px;
            pointer-events: none;
        }

        .search-clear {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 4px;
            display: none;
            border-radius: var(--radius-xs);
        }

        .search-clear:hover {
            color: var(--text-primary);
            background: var(--bg-tertiary);
        }

        .search-clear.visible {
            display: flex;
        }

        .search-clear svg {
            width: 16px;
            height: 16px;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .header-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            padding: 10px;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: var(--transition-fast);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .header-btn:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .header-btn svg {
            width: 22px;
            height: 22px;
        }

        .add-entry-btn {
            background: var(--accent-primary);
            color: white;
            padding: 10px 18px;
            border-radius: var(--radius-md);
            font-weight: 600;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            border: none;
            cursor: pointer;
            transition: var(--transition);
        }

        .add-entry-btn:hover {
            background: var(--accent-hover);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .add-entry-btn svg {
            width: 18px;
            height: 18px;
        }

        /* ========================================
           END OF CHUNK 1
           Next chunk continues with more CSS...
        ======================================== */
    
	        /* ========================================
           ENTRIES LIST & CARDS
        ======================================== */
        .entries-container {
            flex: 1;
            padding: var(--space-lg);
            overflow-y: auto;
        }

        .entries-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-lg);
        }

        .entries-title {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .entries-count {
            color: var(--text-muted);
            font-size: 0.875rem;
        }

        .entries-sort {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .sort-select {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 0.875rem;
            cursor: pointer;
        }

        .entries-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: var(--space-md);
        }

        .entry-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            cursor: pointer;
            transition: var(--transition);
            position: relative;
        }

        .entry-card:hover {
            border-color: var(--accent-primary);
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .entry-card-header {
            display: flex;
            align-items: flex-start;
            gap: var(--space-md);
            margin-bottom: var(--space-md);
        }

        .entry-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            font-weight: 700;
            text-transform: uppercase;
            flex-shrink: 0;
        }

        .entry-icon.cat-social { background: rgba(233, 30, 99, 0.15); color: var(--cat-social); }
        .entry-icon.cat-banking { background: rgba(76, 175, 80, 0.15); color: var(--cat-banking); }
        .entry-icon.cat-email { background: rgba(33, 150, 243, 0.15); color: var(--cat-email); }
        .entry-icon.cat-work { background: rgba(255, 152, 0, 0.15); color: var(--cat-work); }
        .entry-icon.cat-shopping { background: rgba(156, 39, 176, 0.15); color: var(--cat-shopping); }
        .entry-icon.cat-travel { background: rgba(0, 188, 212, 0.15); color: var(--cat-travel); }
        .entry-icon.cat-entertainment { background: rgba(244, 67, 54, 0.15); color: var(--cat-entertainment); }
        .entry-icon.cat-health { background: rgba(139, 195, 74, 0.15); color: var(--cat-health); }
        .entry-icon.cat-education { background: rgba(63, 81, 181, 0.15); color: var(--cat-education); }
        .entry-icon.cat-other { background: rgba(96, 125, 139, 0.15); color: var(--cat-other); }

        .entry-info {
            flex: 1;
            min-width: 0;
        }

        .entry-title {
            font-weight: 600;
            font-size: 1rem;
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .entry-username {
            color: var(--text-muted);
            font-size: 0.875rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .entry-favorite {
            position: absolute;
            top: var(--space-md);
            right: var(--space-md);
            color: var(--text-muted);
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            transition: var(--transition-fast);
        }

        .entry-favorite:hover {
            color: var(--warning);
        }

        .entry-favorite.active {
            color: var(--warning);
        }

        .entry-favorite svg {
            width: 20px;
            height: 20px;
        }

        .entry-card-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding-top: var(--space-md);
            border-top: 1px solid var(--border-light);
        }

        .entry-category {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .entry-category-dot {
            width: 8px;
            height: 8px;
            border-radius: var(--radius-full);
        }

        .entry-actions {
            display: flex;
            gap: 4px;
        }

        .entry-action-btn {
            background: none;
            border: none;
            color: var(--text-muted);
            padding: 6px;
            border-radius: var(--radius-xs);
            cursor: pointer;
            transition: var(--transition-fast);
        }

        .entry-action-btn:hover {
            background: var(--bg-hover);
            color: var(--accent-primary);
        }

        .entry-action-btn svg {
            width: 18px;
            height: 18px;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: var(--space-2xl) var(--space-lg);
        }

        .empty-state-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto var(--space-lg);
            background: var(--bg-tertiary);
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
        }

        .empty-state-icon svg {
            width: 40px;
            height: 40px;
        }

        .empty-state-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: var(--space-sm);
        }

        .empty-state-text {
            color: var(--text-muted);
            margin-bottom: var(--space-lg);
        }

        /* ========================================
           MODAL STYLES
        ======================================== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: var(--space-md);
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            width: 100%;
            max-width: 560px;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transform: scale(0.95) translateY(20px);
            transition: var(--transition);
        }

        .modal-overlay.active .modal {
            transform: scale(1) translateY(0);
        }

        .modal.modal-lg {
            max-width: 700px;
        }

        .modal.modal-sm {
            max-width: 400px;
        }

        .modal-header {
            padding: var(--space-lg);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 700;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: var(--space-sm);
            border-radius: var(--radius-sm);
            transition: var(--transition-fast);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .modal-close svg {
            width: 22px;
            height: 22px;
        }

        .modal-body {
            padding: var(--space-lg);
            overflow-y: auto;
            flex: 1;
        }

        .modal-footer {
            padding: var(--space-md) var(--space-lg);
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
            gap: var(--space-sm);
        }

        /* ========================================
           FORM ELEMENTS IN MODALS
        ======================================== */
        .form-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-md);
        }

        .form-group {
            margin-bottom: var(--space-md);
        }

        .form-group:last-child {
            margin-bottom: 0;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-label {
            display: block;
            margin-bottom: var(--space-xs);
            font-weight: 600;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .form-label .required {
            color: var(--danger);
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-md);
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 0.95rem;
            transition: var(--transition);
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px var(--accent-light);
        }

        .form-input::placeholder,
        .form-textarea::placeholder {
            color: var(--text-muted);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%236b7280' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            padding-right: 40px;
        }

        .input-with-btn {
            display: flex;
            gap: var(--space-sm);
        }

        .input-with-btn .form-input {
            flex: 1;
        }

        .input-with-btn .btn {
            flex-shrink: 0;
        }

        .password-field {
            position: relative;
        }

        .password-field .form-input {
            padding-right: 90px;
        }

        .password-field-actions {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            gap: 4px;
        }

        .password-field-btn {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 6px;
            border-radius: var(--radius-xs);
            transition: var(--transition-fast);
        }

        .password-field-btn:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .password-field-btn svg {
            width: 18px;
            height: 18px;
        }

        /* ========================================
           BUTTONS
        ======================================== */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            padding: 10px 18px;
            border-radius: var(--radius-md);
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            text-decoration: none;
        }

        .btn svg {
            width: 18px;
            height: 18px;
        }

        .btn-primary {
            background: var(--accent-primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--accent-hover);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
            border-color: var(--accent-primary);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: var(--danger-hover);
        }

        .btn-ghost {
            background: transparent;
            color: var(--text-secondary);
        }

        .btn-ghost:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .btn-icon {
            padding: 10px;
        }

        .btn-sm {
            padding: 8px 14px;
            font-size: 0.85rem;
        }

        .btn-lg {
            padding: 14px 24px;
            font-size: 1rem;
        }

        /* ========================================
           PASSWORD GENERATOR PANEL
        ======================================== */
        .generator-panel {
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            margin-top: var(--space-md);
        }

        .generator-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-md);
        }

        .generator-title {
            font-weight: 600;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .generator-title svg {
            width: 18px;
            height: 18px;
            color: var(--accent-primary);
        }

        .generator-output {
            display: flex;
            gap: var(--space-sm);
            margin-bottom: var(--space-md);
        }

        .generator-password {
            flex: 1;
            padding: 12px 16px;
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: var(--radius-md);
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 1rem;
            color: var(--text-primary);
            word-break: break-all;
        }

        .generator-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-md);
        }

        .generator-option {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .generator-option label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            cursor: pointer;
            user-select: none;
        }

        .range-group {
            grid-column: 1 / -1;
        }

        .range-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: var(--space-sm);
        }

        .range-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .range-value {
            font-weight: 600;
            color: var(--accent-primary);
        }

        .range-input {
            width: 100%;
            height: 6px;
            border-radius: var(--radius-full);
            background: var(--border-color);
            outline: none;
            -webkit-appearance: none;
            cursor: pointer;
        }

        .range-input::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: var(--radius-full);
            background: var(--accent-primary);
            cursor: pointer;
            transition: var(--transition-fast);
        }

        .range-input::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            box-shadow: 0 0 0 4px var(--accent-light);
        }

        /* Checkbox Styling */
        .checkbox-wrapper {
            position: relative;
            display: inline-flex;
            align-items: center;
        }

        .checkbox-input {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }

        .checkbox-custom {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-xs);
            background: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition-fast);
            cursor: pointer;
        }

        .checkbox-input:checked + .checkbox-custom {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
        }

        .checkbox-custom svg {
            width: 14px;
            height: 14px;
            color: white;
            opacity: 0;
            transform: scale(0.5);
            transition: var(--transition-fast);
        }

        .checkbox-input:checked + .checkbox-custom svg {
            opacity: 1;
            transform: scale(1);
        }

        .checkbox-input:focus + .checkbox-custom {
            box-shadow: 0 0 0 3px var(--accent-light);
        }

        /* ========================================
           TOAST NOTIFICATIONS
        ======================================== */
        .toast-container {
            position: fixed;
            bottom: var(--space-lg);
            right: var(--space-lg);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
            pointer-events: none;
        }

        .toast {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: var(--space-md) var(--space-lg);
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: var(--space-md);
            min-width: 280px;
            max-width: 400px;
            pointer-events: auto;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .toast.toast-exit {
            animation: slideOut 0.3s ease forwards;
        }

        @keyframes slideOut {
            to {
                opacity: 0;
                transform: translateX(100%);
            }
        }

        .toast-icon {
            width: 24px;
            height: 24px;
            flex-shrink: 0;
        }

        .toast.toast-success .toast-icon { color: var(--success); }
        .toast.toast-error .toast-icon { color: var(--danger); }
        .toast.toast-warning .toast-icon { color: var(--warning); }
        .toast.toast-info .toast-icon { color: var(--info); }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .toast-message {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .toast-close {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 4px;
            border-radius: var(--radius-xs);
            transition: var(--transition-fast);
        }

        .toast-close:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .toast-close svg {
            width: 16px;
            height: 16px;
        }

        .toast-timer {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--accent-primary);
            border-radius: 0 0 var(--radius-md) var(--radius-md);
            animation: timerShrink var(--toast-duration, 4s) linear forwards;
        }

        @keyframes timerShrink {
            from { width: 100%; }
            to { width: 0%; }
        }

        /* ========================================
           SETTINGS PANEL
        ======================================== */
        .settings-section {
            margin-bottom: var(--space-xl);
        }

        .settings-section-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: var(--space-md);
            padding-bottom: var(--space-sm);
            border-bottom: 1px solid var(--border-color);
        }

        .settings-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--space-md) 0;
            border-bottom: 1px solid var(--border-light);
        }

        .settings-item:last-child {
            border-bottom: none;
        }

        .settings-item-info {
            flex: 1;
        }

        .settings-item-title {
            font-weight: 500;
            margin-bottom: 2px;
        }

        .settings-item-desc {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        /* Toggle Switch */
        .toggle-switch {
            position: relative;
            width: 50px;
            height: 28px;
        }

        .toggle-input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--border-color);
            border-radius: var(--radius-full);
            transition: var(--transition);
        }

        .toggle-slider::before {
            content: '';
            position: absolute;
            height: 22px;
            width: 22px;
            left: 3px;
            bottom: 3px;
            background: white;
            border-radius: var(--radius-full);
            transition: var(--transition);
            box-shadow: var(--shadow-sm);
        }

        .toggle-input:checked + .toggle-slider {
            background: var(--accent-primary);
        }

        .toggle-input:checked + .toggle-slider::before {
            transform: translateX(22px);
        }

        .toggle-input:focus + .toggle-slider {
            box-shadow: 0 0 0 3px var(--accent-light);
        }

        /* ========================================
           ENTRY DETAIL VIEW
        ======================================== */
        .entry-detail {
            display: flex;
            flex-direction: column;
            gap: var(--space-lg);
        }

        .entry-detail-header {
            display: flex;
            align-items: center;
            gap: var(--space-lg);
            padding-bottom: var(--space-lg);
            border-bottom: 1px solid var(--border-color);
        }

        .entry-detail-icon {
            width: 64px;
            height: 64px;
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .entry-detail-info h2 {
            font-size: 1.5rem;
            margin-bottom: var(--space-xs);
        }

        .entry-detail-category {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .entry-field {
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            padding: var(--space-md);
        }

        .entry-field-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-muted);
            margin-bottom: var(--space-xs);
        }

        .entry-field-value {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: var(--space-md);
        }

        .entry-field-text {
            flex: 1;
            font-size: 1rem;
            word-break: break-all;
        }

        .entry-field-text.password {
            font-family: 'Consolas', 'Monaco', monospace;
        }

        .entry-field-actions {
            display: flex;
            gap: 4px;
            flex-shrink: 0;
        }

        /* ========================================
           RESPONSIVE DESIGN
        ======================================== */
        @media (max-width: 1024px) {
            .entries-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                width: 280px;
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .sidebar-overlay {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.5);
                z-index: 99;
                opacity: 0;
                visibility: hidden;
                transition: var(--transition);
            }

            .sidebar-overlay.active {
                opacity: 1;
                visibility: visible;
            }

            .main-content {
                margin-left: 0;
            }

            .mobile-menu-btn {
                display: flex;
            }

            .add-entry-btn span {
                display: none;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .entries-grid {
                grid-template-columns: 1fr;
            }

            .generator-options {
                grid-template-columns: 1fr;
            }

            .modal {
                max-height: 100vh;
                border-radius: var(--radius-md);
            }

            .toast-container {
                left: var(--space-md);
                right: var(--space-md);
                bottom: var(--space-md);
            }

            .toast {
                min-width: auto;
                max-width: none;
            }
        }

        @media (max-width: 480px) {
            .lock-container,
            .setup-container {
                padding: var(--space-lg);
            }

            .main-header {
                padding: var(--space-sm) var(--space-md);
            }

            .entries-container {
                padding: var(--space-md);
            }

            .header-actions .header-btn:not(:last-child) {
                display: none;
            }
        }
		/* Powered By Branding */
.powered-by {
    display: block;
    text-align: center;
    font-size: 11px;
    color: var(--text-muted);
    letter-spacing: 1px;
    text-transform: uppercase;
    margin-top: -8px;
    margin-bottom: 8px;
    opacity: 0.5;
}
    </style>
</head>
<body>

    <!-- ========================================
         LOCK SCREEN
    ======================================== -->
    <div id="lockScreen" class="lock-screen hidden">
        <div class="lock-container">
            <div class="lock-logo">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                    <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                </svg>
            </div>
            <h1 class="lock-title">SecureVault</h1>
<span class="powered-by">Powered by Equinox</span>
<p class="lock-subtitle">Enter your master password to unlock</p>
            
            <form id="unlockForm" class="lock-form">
                <div class="password-input-wrapper">
                    <input 
                        type="password" 
                        id="masterPasswordInput" 
                        placeholder="Master Password"
                        autocomplete="current-password"
                        required
                    >
                    <button type="button" class="password-toggle" onclick="togglePasswordVisibility('masterPasswordInput', this)">
                        <svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                            <circle cx="12" cy="12" r="3"></circle>
                        </svg>
                        <svg class="eye-off-icon hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                            <line x1="1" y1="1" x2="23" y2="23"></line>
                        </svg>
                    </button>
                </div>
                <p id="unlockError" class="lock-error"></p>
                <button type="submit" class="lock-btn">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                        <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                    </svg>
                    Unlock Vault
                </button>
				<button type="button" class="lock-btn hidden" id="biometricUnlockBtn" onclick="unlockWithBiometrics()" style="background: var(--success); margin-top: var(--space-sm);">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M12 11c0-1.1.9-2 2-2s2 .9 2 2-2 4-2 4"></path>
        <path d="M8 15s-2-2-2-4c0-2.2 1.8-4 4-4"></path>
        <path d="M12 3c4.4 0 8 3.6 8 8 0 2-2 6-2 6"></path>
        <path d="M4 15s-2-2.5-2-6c0-5 4-9 9-9"></path>
        <path d="M2 12c0 4 3 8 8 10"></path>
        <path d="M14 21c2-1 4-3 5-6"></path>
        <circle cx="12" cy="11" r="1"></circle>
    </svg>
    Unlock with Biometrics
</button>
            </form>

            <div class="lock-footer">
                <p class="lock-footer-text">Don't have a vault yet?</p>
                <div class="lock-actions">
                    <button type="button" class="lock-action-btn" onclick="showSetupWizard()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="8" x2="12" y2="16"></line>
                            <line x1="8" y1="12" x2="16" y2="12"></line>
                        </svg>
                        Create New
                    </button>
                    <button type="button" class="lock-action-btn" onclick="importVault()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        Import
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ========================================
         SETUP WIZARD
    ======================================== -->
    <div id="setupWizard" class="setup-wizard hidden">
        <div class="setup-container">
            <div class="setup-header">
                <div class="setup-step">
                    <span class="setup-step-dot active" data-step="1"></span>
                    <span class="setup-step-dot" data-step="2"></span>
                </div>
                <h1 class="setup-title" id="setupTitle">Create Your Vault</h1>
                <p class="setup-description" id="setupDescription">Choose a strong master password to protect your passwords</p>
            </div>

            <!-- Step 1: Password -->
            <div id="setupStep1" class="setup-form">
			<div class="form-group">
    <label class="form-label">Version</label>
    <input type="number" id="entryVersion" class="form-input" value="1" min="1" max="999" style="width: 100px;">
    <p class="form-hint">Increment if password was compromised</p>
</div>
                <div class="form-group">
                    <label class="form-label">Master Password</label>
                    <div class="password-input-wrapper">
                        <input 
                            type="password" 
                            id="setupPassword" 
                            class="form-input"
                            placeholder="Enter master password"
                            autocomplete="new-password"
                        >
                        <button type="button" class="password-toggle" onclick="togglePasswordVisibility('setupPassword', this)">
                            <svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                            <svg class="eye-off-icon hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                                <line x1="1" y1="1" x2="23" y2="23"></line>
                            </svg>
                        </button>
                    </div>
                    <div class="password-strength">
                        <div class="strength-bar" id="strengthBar1"></div>
                        <div class="strength-bar" id="strengthBar2"></div>
                        <div class="strength-bar" id="strengthBar3"></div>
                        <div class="strength-bar" id="strengthBar4"></div>
                    </div>
                    <p class="strength-text" id="strengthText"></p>
                </div>

                <div class="form-group">
                    <label class="form-label">Confirm Password</label>
                    <div class="password-input-wrapper">
                        <input 
                            type="password" 
                            id="setupPasswordConfirm" 
                            class="form-input"
                            placeholder="Confirm master password"
                            autocomplete="new-password"
                        >
                        <button type="button" class="password-toggle" onclick="togglePasswordVisibility('setupPasswordConfirm', this)">
                            <svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                            <svg class="eye-off-icon hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                                <line x1="1" y1="1" x2="23" y2="23"></line>
                            </svg>
                        </button>
                    </div>
                    <p class="form-hint">Minimum 8 characters. Use a mix of letters, numbers, and symbols.</p>
                </div>

                <p id="setupError" class="lock-error"></p>

                <div class="setup-actions">
                    <button type="button" class="setup-btn setup-btn-secondary" onclick="hideSetupWizard()">
                        Cancel
                    </button>
                    <button type="button" class="setup-btn setup-btn-primary" onclick="goToSetupStep2()">
                        Continue
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                            <polyline points="12 5 19 12 12 19"></polyline>
                        </svg>
                    </button>
                </div>

                <div class="setup-or">or</div>

                <div class="import-area" onclick="importVault()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    <p class="import-area-title">Import Existing Vault</p>
                    <p class="import-area-text">Click or drag your vault-data.json file here</p>
                </div>
            </div>

            <!-- Step 2: Additional Settings -->
            <div id="setupStep2" class="setup-form hidden">
                <div class="form-group">
                    <label class="form-label">Auto-Lock Timeout</label>
                    <select id="setupTimeout" class="form-select">
                        <option value="1">1 minute</option>
                        <option value="5" selected>5 minutes</option>
                        <option value="15">15 minutes</option>
                        <option value="30">30 minutes</option>
                        <option value="60">1 hour</option>
                        <option value="0">Never</option>
                    </select>
                    <p class="form-hint">Automatically lock the vault after inactivity</p>
                </div>

                <div class="form-group">
                    <label class="form-label">Clipboard Clear</label>
                    <select id="setupClipboard" class="form-select">
                        <option value="15">15 seconds</option>
                        <option value="30" selected>30 seconds</option>
                        <option value="60">1 minute</option>
                        <option value="0">Never</option>
                    </select>
                    <p class="form-hint">Automatically clear clipboard after copying passwords</p>
                </div>

                <p id="setupError2" class="lock-error"></p>

                <div class="setup-actions">
                    <button type="button" class="setup-btn setup-btn-secondary" onclick="goToSetupStep1()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="19" y1="12" x2="5" y2="12"></line>
                            <polyline points="12 19 5 12 12 5"></polyline>
                        </svg>
                        Back
                    </button>
                    <button type="button" class="setup-btn setup-btn-primary" onclick="completeSetup()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="20 6 9 17 4 12"></polyline>
                        </svg>
                        Create Vault
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- CHUNK 2 ENDS HERE - DO NOT ADD CLOSING TAGS YET -->
	
    <!-- ========================================
         SIDEBAR OVERLAY (Mobile)
    ======================================== -->
    <div id="sidebarOverlay" class="sidebar-overlay" onclick="closeSidebar()"></div>

    <!-- ========================================
         MAIN APP CONTAINER
    ======================================== -->
    <div id="appContainer" class="app-container hidden">
        
        <!-- Sidebar -->
        <aside id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                        <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                    </svg>
                </div>
                <div class="sidebar-brand">
                    <div class="sidebar-brand-name">SecureVault</div>
                    <div class="sidebar-brand-tagline">Password Manager</div>
                </div>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Main</div>
                    <div class="nav-item active" data-view="all" onclick="filterByView('all')">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="3" width="7" height="7"></rect>
                            <rect x="14" y="3" width="7" height="7"></rect>
                            <rect x="14" y="14" width="7" height="7"></rect>
                            <rect x="3" y="14" width="7" height="7"></rect>
                        </svg>
                        <span class="nav-item-text">All Items</span>
                        <span class="nav-item-count" id="countAll">0</span>
                    </div>
                    <div class="nav-item" data-view="favorites" onclick="filterByView('favorites')">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                        </svg>
                        <span class="nav-item-text">Favorites</span>
                        <span class="nav-item-count" id="countFavorites">0</span>
                    </div>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">Categories</div>
                    <div class="nav-item" data-category="social" onclick="filterByCategory('social')">
                        <span class="category-dot" style="background: var(--cat-social)"></span>
                        <span class="nav-item-text">Social</span>
                        <span class="nav-item-count" id="countSocial">0</span>
                    </div>
                    <div class="nav-item" data-category="banking" onclick="filterByCategory('banking')">
                        <span class="category-dot" style="background: var(--cat-banking)"></span>
                        <span class="nav-item-text">Banking</span>
                        <span class="nav-item-count" id="countBanking">0</span>
                    </div>
                    <div class="nav-item" data-category="email" onclick="filterByCategory('email')">
                        <span class="category-dot" style="background: var(--cat-email)"></span>
                        <span class="nav-item-text">Email</span>
                        <span class="nav-item-count" id="countEmail">0</span>
                    </div>
                    <div class="nav-item" data-category="work" onclick="filterByCategory('work')">
                        <span class="category-dot" style="background: var(--cat-work)"></span>
                        <span class="nav-item-text">Work</span>
                        <span class="nav-item-count" id="countWork">0</span>
                    </div>
                    <div class="nav-item" data-category="shopping" onclick="filterByCategory('shopping')">
                        <span class="category-dot" style="background: var(--cat-shopping)"></span>
                        <span class="nav-item-text">Shopping</span>
                        <span class="nav-item-count" id="countShopping">0</span>
                    </div>
                    <div class="nav-item" data-category="travel" onclick="filterByCategory('travel')">
                        <span class="category-dot" style="background: var(--cat-travel)"></span>
                        <span class="nav-item-text">Travel</span>
                        <span class="nav-item-count" id="countTravel">0</span>
                    </div>
                    <div class="nav-item" data-category="entertainment" onclick="filterByCategory('entertainment')">
                        <span class="category-dot" style="background: var(--cat-entertainment)"></span>
                        <span class="nav-item-text">Entertainment</span>
                        <span class="nav-item-count" id="countEntertainment">0</span>
                    </div>
                    <div class="nav-item" data-category="health" onclick="filterByCategory('health')">
                        <span class="category-dot" style="background: var(--cat-health)"></span>
                        <span class="nav-item-text">Health</span>
                        <span class="nav-item-count" id="countHealth">0</span>
                    </div>
                    <div class="nav-item" data-category="education" onclick="filterByCategory('education')">
                        <span class="category-dot" style="background: var(--cat-education)"></span>
                        <span class="nav-item-text">Education</span>
                        <span class="nav-item-count" id="countEducation">0</span>
                    </div>
                    <div class="nav-item" data-category="other" onclick="filterByCategory('other')">
                        <span class="category-dot" style="background: var(--cat-other)"></span>
                        <span class="nav-item-text">Other</span>
                        <span class="nav-item-count" id="countOther">0</span>
                    </div>
                </div>
            </nav>

            <div class="sidebar-footer">
                <button class="sidebar-footer-btn" onclick="openSettings()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                    </svg>
                    Settings
                </button>
                <button class="sidebar-footer-btn" onclick="exportVault()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="17 8 12 3 7 8"></polyline>
                        <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                    Export Backup
                </button>
                <button class="sidebar-footer-btn danger" onclick="lockVault()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                        <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                    </svg>
                    Lock Vault
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="main-header">
                <button class="mobile-menu-btn" onclick="toggleSidebar()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>

                <div class="search-wrapper">
                    <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                    <input 
                        type="text" 
                        id="searchInput" 
                        class="search-input" 
                        placeholder="Search passwords..."
                        oninput="handleSearch()"
                    >
                    <button class="search-clear" id="searchClear" onclick="clearSearch()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </div>

                <div class="header-actions">
                    <button class="header-btn" onclick="toggleTheme()" title="Toggle Theme">
                        <svg id="themeIconLight" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                        <svg id="themeIconDark" class="hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                    </button>
                    <button class="add-entry-btn" onclick="openAddEntryModal()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        <span>Add Entry</span>
                    </button>
                </div>
            </header>

            <!-- Entries Container -->
            <div class="entries-container">
                <div class="entries-header">
                    <div>
                        <h1 class="entries-title" id="viewTitle">All Items</h1>
                        <p class="entries-count" id="entriesCount">0 passwords</p>
                    </div>
                    <div class="entries-sort">
                        <select class="sort-select" id="sortSelect" onchange="handleSort()">
                            <option value="name-asc">Name (A-Z)</option>
                            <option value="name-desc">Name (Z-A)</option>
                            <option value="date-new">Newest First</option>
                            <option value="date-old">Oldest First</option>
                            <option value="category">Category</option>
                        </select>
                    </div>
                </div>

                <!-- Entries Grid -->
                <div class="entries-grid" id="entriesGrid">
                    <!-- Entries will be rendered here -->
                </div>

                <!-- Empty State -->
                <div class="empty-state hidden" id="emptyState">
                    <div class="empty-state-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                            <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                        </svg>
                    </div>
                    <h3 class="empty-state-title" id="emptyStateTitle">No passwords yet</h3>
                    <p class="empty-state-text" id="emptyStateText">Add your first password to get started</p>
                    <button class="btn btn-primary" onclick="openAddEntryModal()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        Add Entry
                    </button>
                </div>
            </div>
        </main>
    </div>

    <!-- ========================================
         ADD/EDIT ENTRY MODAL
    ======================================== -->
    <div id="entryModal" class="modal-overlay">
        <div class="modal modal-lg">
            <div class="modal-header">
                <h2 class="modal-title" id="entryModalTitle">Add New Entry</h2>
                <button class="modal-close" onclick="closeEntryModal()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <form id="entryForm">
                    <input type="hidden" id="entryId">
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Title <span class="required">*</span></label>
                            <input type="text" id="entryTitle" class="form-input" placeholder="e.g., Facebook" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Category</label>
                            <select id="entryCategory" class="form-select">
                                <option value="social">Social</option>
                                <option value="banking">Banking</option>
                                <option value="email">Email</option>
                                <option value="work">Work</option>
                                <option value="shopping">Shopping</option>
                                <option value="travel">Travel</option>
                                <option value="entertainment">Entertainment</option>
                                <option value="health">Health</option>
                                <option value="education">Education</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Username / Email</label>
                        <input type="text" id="entryUsername" class="form-input" placeholder="username or email@example.com">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Password <span class="required">*</span></label>
                        <div class="password-field">
                            <input type="password" id="entryPassword" class="form-input" placeholder="Enter password" required>
                            <div class="password-field-actions">
                                <button type="button" class="password-field-btn" onclick="togglePasswordVisibility('entryPassword', this)" title="Show/Hide">
                                    <svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                        <circle cx="12" cy="12" r="3"></circle>
                                    </svg>
                                    <svg class="eye-off-icon hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                                        <line x1="1" y1="1" x2="23" y2="23"></line>
                                    </svg>
                                </button>
                                <button type="button" class="password-field-btn" onclick="toggleGeneratorPanel()" title="Generate Password">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <!-- Password Generator Panel -->
                        <div class="generator-panel hidden" id="generatorPanel">
                            <div class="generator-header">
                                <span class="generator-title">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"></path>
                                    </svg>
                                    Password Generator
                                </span>
                            </div>
                            <div class="generator-output">
                                <div class="generator-password" id="generatedPassword">Click generate to create password</div>
                                <button type="button" class="btn btn-secondary btn-icon" onclick="generatePassword()" title="Generate">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <polyline points="23 4 23 10 17 10"></polyline>
                                        <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
                                    </svg>
                                </button>
                                <button type="button" class="btn btn-primary btn-icon" onclick="useGeneratedPassword()" title="Use This Password">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <polyline points="20 6 9 17 4 12"></polyline>
                                    </svg>
                                </button>
                            </div>
							<div class="generator-mode" style="display: flex; gap: var(--space-md); margin-bottom: var(--space-md);">
    <label style="display: flex; align-items: center; gap: var(--space-sm); cursor: pointer;">
        <input type="radio" name="genMode" id="genModeRandom" value="random" checked style="cursor: pointer;">
        <span>Random</span>
    </label>
    <label style="display: flex; align-items: center; gap: var(--space-sm); cursor: pointer;">
        <input type="radio" name="genMode" id="genModeDeterministic" value="deterministic" style="cursor: pointer;">
        <span>Regeneratable</span>
    </label>
</div>
                            <div class="generator-options">
                                <div class="range-group">
                                    <div class="range-header">
                                        <span class="range-label">Password Length</span>
                                        <span class="range-value" id="lengthValue">16</span>
                                    </div>
                                    <input type="range" class="range-input" id="genLength" min="8" max="64" value="16" oninput="updateLengthValue()">
                                </div>
                                <div class="generator-option">
                                    <div class="checkbox-wrapper">
                                        <input type="checkbox" id="genUppercase" class="checkbox-input" checked>
                                        <label class="checkbox-custom" for="genUppercase">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                                                <polyline points="20 6 9 17 4 12"></polyline>
                                            </svg>
                                        </label>
                                    </div>
                                    <label for="genUppercase">Uppercase (A-Z)</label>
                                </div>
                                <div class="generator-option">
                                    <div class="checkbox-wrapper">
                                        <input type="checkbox" id="genLowercase" class="checkbox-input" checked>
                                        <label class="checkbox-custom" for="genLowercase">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                                                <polyline points="20 6 9 17 4 12"></polyline>
                                            </svg>
                                        </label>
                                    </div>
                                    <label for="genLowercase">Lowercase (a-z)</label>
                                </div>
                                <div class="generator-option">
                                    <div class="checkbox-wrapper">
                                        <input type="checkbox" id="genNumbers" class="checkbox-input" checked>
                                        <label class="checkbox-custom" for="genNumbers">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                                                <polyline points="20 6 9 17 4 12"></polyline>
                                            </svg>
                                        </label>
                                    </div>
                                    <label for="genNumbers">Numbers (0-9)</label>
                                </div>
                                <div class="generator-option">
                                    <div class="checkbox-wrapper">
                                        <input type="checkbox" id="genSymbols" class="checkbox-input" checked>
                                        <label class="checkbox-custom" for="genSymbols">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                                                <polyline points="20 6 9 17 4 12"></polyline>
                                            </svg>
                                        </label>
                                    </div>
                                    <label for="genSymbols">Symbols (!@#$%)</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Website URL</label>
                        <input type="url" id="entryUrl" class="form-input" placeholder="https://example.com">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Notes</label>
                        <textarea id="entryNotes" class="form-textarea" placeholder="Additional information..."></textarea>
                    </div>

                    <div class="form-group">
                        <div class="generator-option">
                            <div class="checkbox-wrapper">
                                <input type="checkbox" id="entryFavorite" class="checkbox-input">
                                <label class="checkbox-custom" for="entryFavorite">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                                        <polyline points="20 6 9 17 4 12"></polyline>
                                    </svg>
                                </label>
                            </div>
                            <label for="entryFavorite">Add to Favorites</label>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeEntryModal()">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="saveEntry()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                        <polyline points="17 21 17 13 7 13 7 21"></polyline>
                        <polyline points="7 3 7 8 15 8"></polyline>
                    </svg>
                    Save Entry
                </button>
            </div>
        </div>
    </div>

    <!-- ========================================
         VIEW ENTRY MODAL
    ======================================== -->
    <div id="viewEntryModal" class="modal-overlay">
        <div class="modal modal-lg">
            <div class="modal-header">
                <h2 class="modal-title">Entry Details</h2>
                <button class="modal-close" onclick="closeViewEntryModal()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="entry-detail">
                    <div class="entry-detail-header">
                        <div class="entry-detail-icon" id="viewEntryIcon">FB</div>
                        <div class="entry-detail-info">
                            <h2 id="viewEntryTitle">Facebook</h2>
                            <div class="entry-detail-category">
                                <span class="category-dot" id="viewEntryCategoryDot"></span>
                                <span id="viewEntryCategory">Social</span>
                            </div>
                        </div>
                    </div>

                    <div class="entry-field" id="viewUsernameField">
                        <div class="entry-field-label">Username / Email</div>
                        <div class="entry-field-value">
                            <span class="entry-field-text" id="viewEntryUsername">user@example.com</span>
                            <div class="entry-field-actions">
                                <button class="btn btn-ghost btn-icon btn-sm" onclick="copyToClipboard(document.getElementById('viewEntryUsername').textContent, 'Username')" title="Copy">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="entry-field">
                        <div class="entry-field-label">Password</div>
                        <div class="entry-field-value">
                            <span class="entry-field-text password" id="viewEntryPassword">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</span>
                            <div class="entry-field-actions">
                                <button class="btn btn-ghost btn-icon btn-sm" id="viewPasswordToggle" onclick="toggleViewPassword()" title="Show/Hide">
                                    <svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                        <circle cx="12" cy="12" r="3"></circle>
                                    </svg>
                                    <svg class="eye-off-icon hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                                        <line x1="1" y1="1" x2="23" y2="23"></line>
                                    </svg>
                                </button>
                                <button class="btn btn-ghost btn-icon btn-sm" onclick="copyEntryPassword()" title="Copy">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                    </svg>
                                </button>
								<button class="btn btn-ghost btn-icon btn-sm" onclick="regenerateEntryPassword()" title="Regenerate">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="23 4 23 10 17 10"></polyline>
        <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
    </svg>
</button>

                            </div>
                        </div>
                    </div>

                    <div class="entry-field hidden" id="viewUrlField">
                        <div class="entry-field-label">Website</div>
                        <div class="entry-field-value">
                            <a href="#" class="entry-field-text" id="viewEntryUrl" target="_blank" rel="noopener noreferrer">https://example.com</a>
                            <div class="entry-field-actions">
                                <button class="btn btn-ghost btn-icon btn-sm" onclick="openEntryUrl()" title="Open">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                                        <polyline points="15 3 21 3 21 9"></polyline>
                                        <line x1="10" y1="14" x2="21" y2="3"></line>
                                    </svg>
                                </button>
                                <button class="btn btn-ghost btn-icon btn-sm" onclick="copyToClipboard(document.getElementById('viewEntryUrl').textContent, 'URL')" title="Copy">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="entry-field hidden" id="viewNotesField">
                        <div class="entry-field-label">Notes</div>
                        <div class="entry-field-value">
                            <span class="entry-field-text" id="viewEntryNotes" style="white-space: pre-wrap;"></span>
                        </div>
                    </div>

                    <div class="entry-field">
                        <div class="entry-field-label">Last Modified</div>
                        <div class="entry-field-value">
                            <span class="entry-field-text text-muted" id="viewEntryModified">January 1, 2024</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" onclick="confirmDeleteEntry()" style="margin-right: auto;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="3 6 5 6 21 6"></polyline>
                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                    </svg>
                    Delete
                </button>
                <button type="button" class="btn btn-secondary" onclick="closeViewEntryModal()">Close</button>
                <button type="button" class="btn btn-primary" onclick="editCurrentEntry()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                    </svg>
                    Edit
                </button>
            </div>
        </div>
    </div>

    <!-- ========================================
         DELETE CONFIRMATION MODAL
    ======================================== -->
    <div id="deleteModal" class="modal-overlay">
        <div class="modal modal-sm">
            <div class="modal-header">
                <h2 class="modal-title">Delete Entry</h2>
                <button class="modal-close" onclick="closeDeleteModal()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body text-center">
                <div class="empty-state-icon" style="background: var(--danger-light); margin-bottom: var(--space-md);">
                    <svg viewBox="0 0 24 24" fill="none" stroke="var(--danger)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="3 6 5 6 21 6"></polyline>
                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                        <line x1="10" y1="11" x2="10" y2="17"></line>
                        <line x1="14" y1="11" x2="14" y2="17"></line>
                    </svg>
                </div>
                <p>Are you sure you want to delete <strong id="deleteEntryName">this entry</strong>?</p>
                <p class="text-muted" style="font-size: 0.875rem; margin-top: var(--space-sm);">This action cannot be undone.</p>
            </div>
            <div class="modal-footer" style="justify-content: center;">
                <button type="button" class="btn btn-secondary" onclick="closeDeleteModal()">Cancel</button>
                <button type="button" class="btn btn-danger" onclick="deleteEntry()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="3 6 5 6 21 6"></polyline>
                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                    </svg>
                    Delete Entry
                </button>
            </div>
        </div>
    </div>

    <!-- CHUNK 3 ENDS HERE - DO NOT ADD CLOSING TAGS YET -->
	
    <!-- ========================================
         SETTINGS MODAL
    ======================================== -->
    <div id="settingsModal" class="modal-overlay">
        <div class="modal modal-lg">
            <div class="modal-header">
                <h2 class="modal-title">Settings</h2>
                <button class="modal-close" onclick="closeSettings()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
			<!-- Quick Access Section -->
<div class="settings-section">
    <h3 class="settings-section-title">Quick Access</h3>
    
    <div class="settings-item">
        <div class="settings-item-info">
            <div class="settings-item-title">Install App</div>
            <div class="settings-item-desc">Add to home screen for quick access</div>
        </div>
        <button class="btn btn-secondary btn-sm" id="installPwaBtn" onclick="installPwa()" style="display: none;">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:16px;height:16px;">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
            Install
        </button>
        <span id="pwaInstalledText" class="text-muted" style="font-size: 0.85rem; display: none;">Installed</span>
    </div>

    <div class="settings-item" style="flex-direction: column; align-items: flex-start; gap: var(--space-sm);">
        <div class="settings-item-info">
            <div class="settings-item-title">Bookmarklet</div>
            <div class="settings-item-desc">Drag this to your bookmarks bar for quick access from any site</div>
        </div>
        <div style="display: flex; gap: var(--space-sm); align-items: center; flex-wrap: wrap;">
            <a href="#" id="vaultBookmarklet" class="btn btn-primary btn-sm" style="cursor: grab;" onclick="event.preventDefault(); showToast('info', 'Drag Me', 'Drag this button to your bookmarks bar');">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:16px;height:16px;">
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                    <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                </svg>
                SecureVault
            </a>
            <button class="btn btn-secondary btn-sm" onclick="copyBookmarklet()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:16px;height:16px;">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                </svg>
                Copy Code
            </button>
        </div>
        <div class="form-group" style="width: 100%; margin-top: var(--space-sm);">
            <label class="form-label">Vault URL (for bookmarklet)</label>
            <input type="url" id="vaultUrl" class="form-input" placeholder="https://yoursite.com/vault.html" onchange="updateBookmarklet()">
            <p class="form-hint">Enter the URL where your vault is hosted, or leave blank for current location</p>
        </div>
    </div>
</div>
                <!-- Security Section -->
                <div class="settings-section">
                    <h3 class="settings-section-title">Security</h3>
                    
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-title">Auto-Lock Timeout</div>
                            <div class="settings-item-desc">Lock vault after inactivity</div>
                        </div>
                        <select id="settingsTimeout" class="form-select" style="width: auto;" onchange="updateSettings()">
                            <option value="1">1 minute</option>
                            <option value="5">5 minutes</option>
                            <option value="15">15 minutes</option>
                            <option value="30">30 minutes</option>
                            <option value="60">1 hour</option>
                            <option value="0">Never</option>
                        </select>
                    </div>

                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-title">Clipboard Auto-Clear</div>
                            <div class="settings-item-desc">Clear clipboard after copying</div>
                        </div>
                        <select id="settingsClipboard" class="form-select" style="width: auto;" onchange="updateSettings()">
                            <option value="15">15 seconds</option>
                            <option value="30">30 seconds</option>
                            <option value="60">1 minute</option>
                            <option value="0">Never</option>
                        </select>
                    </div>

                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-title">Change Master Password</div>
                            <div class="settings-item-desc">Update your vault password</div>
                        </div>
                        <button class="btn btn-secondary btn-sm" onclick="showChangePassword()">
                            Change
                        </button>
                    </div>
					<div class="settings-item" id="biometricsSettingItem">
    <div class="settings-item-info">
        <div class="settings-item-title">Biometric Unlock</div>
        <div class="settings-item-desc" id="biometricsDesc">Use fingerprint or Windows Hello to unlock</div>
    </div>
    <label class="toggle-switch">
        <input type="checkbox" class="toggle-input" id="settingsBiometrics" onchange="toggleBiometrics()">
        <span class="toggle-slider"></span>
    </label>
</div>
<div class="settings-item hidden" id="biometricsRemoveItem">
    <div class="settings-item-info">
        <div class="settings-item-title" style="color: var(--danger);">Remove Biometric Data</div>
        <div class="settings-item-desc">Disable biometrics and remove stored credentials</div>
    </div>
    <button class="btn btn-danger btn-sm" onclick="removeBiometrics()">
        Remove
    </button>
</div>
                </div>

                <!-- Appearance Section -->
                <div class="settings-section">
                    <h3 class="settings-section-title">Appearance</h3>
                    
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-title">Dark Mode</div>
                            <div class="settings-item-desc">Use dark color scheme</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" class="toggle-input" id="settingsDarkMode" onchange="toggleThemeFromSettings()">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <!-- Data Section -->
                <div class="settings-section">
                    <h3 class="settings-section-title">Data Management</h3>
                    
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-title">Export Vault</div>
                            <div class="settings-item-desc">Download encrypted backup file</div>
                        </div>
                        <button class="btn btn-secondary btn-sm" onclick="exportVault()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:16px;height:16px;">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="17 8 12 3 7 8"></polyline>
                                <line x1="12" y1="3" x2="12" y2="15"></line>
                            </svg>
                            Export
                        </button>
                    </div>

                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-title">Import Vault</div>
                            <div class="settings-item-desc">Restore from backup file</div>
                        </div>
                        <button class="btn btn-secondary btn-sm" onclick="importVault()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:16px;height:16px;">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="7 10 12 15 17 10"></polyline>
                                <line x1="12" y1="15" x2="12" y2="3"></line>
                            </svg>
                            Import
                        </button>
                    </div>

                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-title">Delete All Data</div>
                            <div class="settings-item-desc" style="color: var(--danger);">Permanently delete vault and all passwords</div>
                        </div>
                        <button class="btn btn-danger btn-sm" onclick="confirmDeleteAllData()">
                            Delete All
                        </button>
                    </div>
                </div>

                <!-- About Section -->
                <div class="settings-section">
                    <h3 class="settings-section-title">About</h3>
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-title">SecureVault</div>
							<div class="settings-item-desc" style="opacity: 0.5; font-size: 11px; letter-spacing: 1px; text-transform: uppercase;">Powered by Equinox</div>
                            <div class="settings-item-desc">Version 1.0.0 ‚Ä¢ Offline Password Manager</div>
                        </div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-title">Encryption</div>
                            <div class="settings-item-desc">AES-256-GCM via Web Crypto API</div>
                        </div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-title">Total Entries</div>
                            <div class="settings-item-desc" id="settingsTotalEntries">0 passwords stored</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" onclick="closeSettings()">Done</button>
            </div>
        </div>
    </div>

    <!-- ========================================
         CHANGE PASSWORD MODAL
    ======================================== -->
    <div id="changePasswordModal" class="modal-overlay">
        <div class="modal modal-sm">
            <div class="modal-header">
                <h2 class="modal-title">Change Master Password</h2>
                <button class="modal-close" onclick="closeChangePassword()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Current Password</label>
                    <div class="password-input-wrapper">
                        <input type="password" id="currentPassword" class="form-input" placeholder="Enter current password">
                        <button type="button" class="password-toggle" onclick="togglePasswordVisibility('currentPassword', this)">
                            <svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                            <svg class="eye-off-icon hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                                <line x1="1" y1="1" x2="23" y2="23"></line>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">New Password</label>
                    <div class="password-input-wrapper">
                        <input type="password" id="newPassword" class="form-input" placeholder="Enter new password" oninput="checkNewPasswordStrength()">
                        <button type="button" class="password-toggle" onclick="togglePasswordVisibility('newPassword', this)">
                            <svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                            <svg class="eye-off-icon hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                                <line x1="1" y1="1" x2="23" y2="23"></line>
                            </svg>
                        </button>
                    </div>
                    <div class="password-strength" style="margin-top: var(--space-xs);">
                        <div class="strength-bar" id="newStrengthBar1"></div>
                        <div class="strength-bar" id="newStrengthBar2"></div>
                        <div class="strength-bar" id="newStrengthBar3"></div>
                        <div class="strength-bar" id="newStrengthBar4"></div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Confirm New Password</label>
                    <div class="password-input-wrapper">
                        <input type="password" id="confirmNewPassword" class="form-input" placeholder="Confirm new password">
                        <button type="button" class="password-toggle" onclick="togglePasswordVisibility('confirmNewPassword', this)">
                            <svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                            <svg class="eye-off-icon hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                                <line x1="1" y1="1" x2="23" y2="23"></line>
                            </svg>
                        </button>
                    </div>
                </div>
                <p id="changePasswordError" class="lock-error"></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeChangePassword()">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="changePassword()">
                    Change Password
                </button>
            </div>
        </div>
    </div>

    <!-- ========================================
         DELETE ALL DATA MODAL
    ======================================== -->
    <div id="deleteAllModal" class="modal-overlay">
        <div class="modal modal-sm">
            <div class="modal-header">
                <h2 class="modal-title" style="color: var(--danger);">Delete All Data</h2>
                <button class="modal-close" onclick="closeDeleteAllModal()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body text-center">
                <div class="empty-state-icon" style="background: var(--danger-light); margin-bottom: var(--space-md);">
                    <svg viewBox="0 0 24 24" fill="none" stroke="var(--danger)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                        <line x1="12" y1="9" x2="12" y2="13"></line>
                        <line x1="12" y1="17" x2="12.01" y2="17"></line>
                    </svg>
                </div>
                <p><strong>This will permanently delete:</strong></p>
                <ul style="text-align: left; margin: var(--space-md) 0; padding-left: var(--space-lg); color: var(--text-secondary);">
                    <li>All saved passwords</li>
                    <li>All settings</li>
                    <li>Your master password</li>
                </ul>
                <div class="form-group" style="text-align: left;">
                    <label class="form-label">Type "DELETE" to confirm</label>
                    <input type="text" id="deleteConfirmInput" class="form-input" placeholder="DELETE">
                </div>
            </div>
            <div class="modal-footer" style="justify-content: center;">
                <button type="button" class="btn btn-secondary" onclick="closeDeleteAllModal()">Cancel</button>
                <button type="button" class="btn btn-danger" onclick="deleteAllData()">
                    Delete Everything
                </button>
            </div>
        </div>
    </div>

    <!-- ========================================
         TOAST CONTAINER
    ======================================== -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- ========================================
         HIDDEN FILE INPUT
    ======================================== -->
    <input type="file" id="fileInput" accept=".json" style="display: none;" onchange="handleFileImport(event)">

    <!-- ========================================
         JAVASCRIPT
    ======================================== -->
    <script>
        // ========================================
        // APPLICATION STATE
        // ========================================
        const AppState = {
            // Encryption
            masterKey: null,
            salt: null,
            
            // Data
            entries: [],
            settings: {
                autoLockTimeout: 5,
                clipboardClear: 30,
                theme: 'system'
            },
            
            // UI State
            currentView: 'all',
            currentCategory: null,
            currentEntryId: null,
            searchQuery: '',
            sortBy: 'name-asc',
            
            // Timers
            autoLockTimer: null,
            clipboardTimer: null,
            clipboardCountdown: null,
            
            // Flags
            isUnlocked: false,
            hasVault: false,
            isDirty: false
        };

        // ========================================
        // CONSTANTS
        // ========================================
        const STORAGE_KEY = 'securevault_data';
        const SETTINGS_KEY = 'securevault_settings';
        const CATEGORIES = {
            social: { name: 'Social', color: 'var(--cat-social)' },
            banking: { name: 'Banking', color: 'var(--cat-banking)' },
            email: { name: 'Email', color: 'var(--cat-email)' },
            work: { name: 'Work', color: 'var(--cat-work)' },
            shopping: { name: 'Shopping', color: 'var(--cat-shopping)' },
            travel: { name: 'Travel', color: 'var(--cat-travel)' },
            entertainment: { name: 'Entertainment', color: 'var(--cat-entertainment)' },
            health: { name: 'Health', color: 'var(--cat-health)' },
            education: { name: 'Education', color: 'var(--cat-education)' },
            other: { name: 'Other', color: 'var(--cat-other)' }
        };

        // ========================================
        // ENCRYPTION FUNCTIONS (Web Crypto API)
        // ========================================
        
        // Generate a random salt
        function generateSalt() {
            return crypto.getRandomValues(new Uint8Array(16));
        }

        // Derive encryption key from password using PBKDF2
        async function deriveKey(password, salt) {
            const encoder = new TextEncoder();
            const passwordBuffer = encoder.encode(password);
            
            // Import password as key material
            const keyMaterial = await crypto.subtle.importKey(
                'raw',
                passwordBuffer,
                'PBKDF2',
                false,
                ['deriveKey']
            );
            
            // Derive AES-GCM key
            const key = await crypto.subtle.deriveKey(
                {
                    name: 'PBKDF2',
                    salt: salt,
                    iterations: 100000,
                    hash: 'SHA-256'
                },
                keyMaterial,
                {
                    name: 'AES-GCM',
                    length: 256
                },
                false,
                ['encrypt', 'decrypt']
            );
            
            return key;
        }

        // Encrypt data using AES-256-GCM
        async function encryptData(data, key) {
            const encoder = new TextEncoder();
            const dataBuffer = encoder.encode(JSON.stringify(data));
            
            // Generate random IV
            const iv = crypto.getRandomValues(new Uint8Array(12));
            
            // Encrypt
            const encryptedBuffer = await crypto.subtle.encrypt(
                {
                    name: 'AES-GCM',
                    iv: iv
                },
                key,
                dataBuffer
            );
            
            // Combine IV and encrypted data
            const combined = new Uint8Array(iv.length + encryptedBuffer.byteLength);
            combined.set(iv);
            combined.set(new Uint8Array(encryptedBuffer), iv.length);
            
            // Return as base64
            return btoa(String.fromCharCode(...combined));
        }

        // Decrypt data using AES-256-GCM
        async function decryptData(encryptedBase64, key) {
            try {
                // Decode base64
                const combined = Uint8Array.from(atob(encryptedBase64), c => c.charCodeAt(0));
                
                // Extract IV and encrypted data
                const iv = combined.slice(0, 12);
                const encryptedData = combined.slice(12);
                
                // Decrypt
                const decryptedBuffer = await crypto.subtle.decrypt(
                    {
                        name: 'AES-GCM',
                        iv: iv
                    },
                    key,
                    encryptedData
                );
                
                // Decode and parse
                const decoder = new TextDecoder();
                const jsonString = decoder.decode(decryptedBuffer);
                return JSON.parse(jsonString);
            } catch (error) {
                console.error('Decryption failed:', error);
                return null;
            }
        }

        // Convert Uint8Array to hex string
        function arrayToHex(array) {
            return Array.from(array).map(b => b.toString(16).padStart(2, '0')).join('');
        }

        // Convert hex string to Uint8Array
        function hexToArray(hex) {
            const bytes = new Uint8Array(hex.length / 2);
            for (let i = 0; i < bytes.length; i++) {
                bytes[i] = parseInt(hex.substr(i * 2, 2), 16);
            }
            return bytes;
        }

        // ========================================
        // STORAGE FUNCTIONS
        // ========================================
        
        // Save encrypted vault to localStorage
        async function saveVault() {
            if (!AppState.masterKey || !AppState.salt) {
                console.error('Cannot save: No master key');
                return false;
            }
            
            try {
                const vaultData = {
                    entries: AppState.entries,
                    settings: AppState.settings,
                    updatedAt: new Date().toISOString()
                };
                
                const encryptedData = await encryptData(vaultData, AppState.masterKey);
                
                const storageData = {
                    salt: arrayToHex(AppState.salt),
                    data: encryptedData,
                    version: '1.0'
                };
                
                localStorage.setItem(STORAGE_KEY, JSON.stringify(storageData));
                AppState.isDirty = false;
                
                return true;
            } catch (error) {
                console.error('Failed to save vault:', error);
                showToast('error', 'Save Failed', 'Could not save vault data');
                return false;
            }
        }

        // Load vault from localStorage
        function loadStoredVault() {
            try {
                const stored = localStorage.getItem(STORAGE_KEY);
                if (stored) {
                    return JSON.parse(stored);
                }
            } catch (error) {
                console.error('Failed to load stored vault:', error);
            }
            return null;
        }

        // Check if vault exists
        function checkVaultExists() {
            const stored = loadStoredVault();
            return stored && stored.salt && stored.data;
        }

        // ========================================
        // INITIALIZATION
        // ========================================
        
        function init() {
            // Load theme preference
            loadThemePreference();
            
            // Check if vault exists
            AppState.hasVault = checkVaultExists();
            
            if (AppState.hasVault) {
                // Show lock screen
                showLockScreen();
            } else {
                // Show setup wizard for new users
                showSetupWizard();
            }
            
            // Setup event listeners
            setupEventListeners();
			// Check biometrics availability on load
checkBiometricsOnLoad();
			// Setup PWA
setupPwa();

// Setup Bookmarklet
setupBookmarklet();
        }

        function setupEventListeners() {
            // Unlock form submission
            document.getElementById('unlockForm').addEventListener('submit', handleUnlock);
            
            // Password strength checking for setup
            document.getElementById('setupPassword').addEventListener('input', checkSetupPasswordStrength);
            
            // Activity tracking for auto-lock
            ['mousedown', 'keydown', 'touchstart', 'scroll'].forEach(event => {
                document.addEventListener(event, resetAutoLockTimer);
            });
            
            // Keyboard shortcuts
            document.addEventListener('keydown', handleKeyboardShortcuts);
            
            // Before unload warning
            window.addEventListener('beforeunload', (e) => {
                if (AppState.isDirty) {
                    e.preventDefault();
                    e.returnValue = '';
                }
            });
        }

        function handleKeyboardShortcuts(e) {
            // Only when vault is unlocked
            if (!AppState.isUnlocked) return;
            
            // Ctrl/Cmd + N = New entry
            if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
                e.preventDefault();
                openAddEntryModal();
            }
            
            // Ctrl/Cmd + F = Focus search
            if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
                e.preventDefault();
                document.getElementById('searchInput').focus();
            }
            
            // Ctrl/Cmd + L = Lock vault
            if ((e.ctrlKey || e.metaKey) && e.key === 'l') {
                e.preventDefault();
                lockVault();
            }
            
            // Escape = Close modals
            if (e.key === 'Escape') {
                closeAllModals();
            }
        }

        // ========================================
        // LOCK SCREEN FUNCTIONS
        // ========================================
        
        function showLockScreen() {
    document.getElementById('lockScreen').classList.remove('hidden');
    document.getElementById('setupWizard').classList.add('hidden');
    document.getElementById('appContainer').classList.add('hidden');
    document.getElementById('masterPasswordInput').focus();
    
    // Check if biometrics available
    checkBiometricsOnLoad();
}

        function hideLockScreen() {
            document.getElementById('lockScreen').classList.add('hidden');
        }

        async function handleUnlock(e) {
            e.preventDefault();
            
            const password = document.getElementById('masterPasswordInput').value;
            const errorEl = document.getElementById('unlockError');
            
            if (!password) {
                errorEl.textContent = 'Please enter your password';
                return;
            }
            
            errorEl.textContent = '';
            
            try {
                const stored = loadStoredVault();
                if (!stored) {
                    errorEl.textContent = 'No vault found';
                    return;
                }
                
                // Derive key from password
                const salt = hexToArray(stored.salt);
                const key = await deriveKey(password, salt);
                
                // Try to decrypt
                const decrypted = await decryptData(stored.data, key);
                
                if (!decrypted) {
                    errorEl.textContent = 'Incorrect password';
                    document.getElementById('masterPasswordInput').value = '';
                    document.getElementById('masterPasswordInput').focus();
                    return;
                }
                
                // Success! Store key and load data
                AppState.masterKey = key;
                AppState.salt = salt;
                AppState.entries = decrypted.entries || [];
                AppState.settings = { ...AppState.settings, ...decrypted.settings };
                AppState.isUnlocked = true;
                
                // Clear password input
                document.getElementById('masterPasswordInput').value = '';
                
                // Show app
                hideLockScreen();
                showApp();
                
                showToast('success', 'Welcome Back', 'Vault unlocked successfully');
                
            } catch (error) {
                console.error('Unlock error:', error);
                errorEl.textContent = 'Failed to unlock vault';
            }
        }

        function lockVault() {
            // Clear sensitive data
            AppState.masterKey = null;
            AppState.entries = [];
            AppState.isUnlocked = false;
            AppState.currentEntryId = null;
            
            // Clear timers
            clearAutoLockTimer();
            clearClipboardTimer();
            
            // Close all modals
            closeAllModals();
            
            // Hide app, show lock screen
            document.getElementById('appContainer').classList.add('hidden');
            showLockScreen();
            
            showToast('info', 'Vault Locked', 'Your vault has been locked');
        }

        // ========================================
        // SETUP WIZARD FUNCTIONS
        // ========================================
        
        function showSetupWizard() {
            document.getElementById('setupWizard').classList.remove('hidden');
            document.getElementById('lockScreen').classList.add('hidden');
            document.getElementById('appContainer').classList.add('hidden');
            
            // Reset to step 1
            goToSetupStep1();
        }

        function hideSetupWizard() {
            document.getElementById('setupWizard').classList.add('hidden');
            
            if (AppState.hasVault) {
                showLockScreen();
            }
        }

        function goToSetupStep1() {
            document.getElementById('setupStep1').classList.remove('hidden');
            document.getElementById('setupStep2').classList.add('hidden');
            document.getElementById('setupTitle').textContent = 'Create Your Vault';
            document.getElementById('setupDescription').textContent = 'Choose a strong master password to protect your passwords';
            
            // Update step indicators
            document.querySelector('[data-step="1"]').classList.add('active');
            document.querySelector('[data-step="2"]').classList.remove('active');
        }

        function goToSetupStep2() {
            const password = document.getElementById('setupPassword').value;
            const confirm = document.getElementById('setupPasswordConfirm').value;
            const errorEl = document.getElementById('setupError');
            
            // Validation
            if (!password) {
                errorEl.textContent = 'Please enter a password';
                return;
            }
            
            if (password.length < 8) {
                errorEl.textContent = 'Password must be at least 8 characters';
                return;
            }
            
            if (password !== confirm) {
                errorEl.textContent = 'Passwords do not match';
                return;
            }
            
            errorEl.textContent = '';
            
            // Show step 2
            document.getElementById('setupStep1').classList.add('hidden');
            document.getElementById('setupStep2').classList.remove('hidden');
            document.getElementById('setupTitle').textContent = 'Configure Settings';
            document.getElementById('setupDescription').textContent = 'Customize your security preferences';
            
            // Update step indicators
            document.querySelector('[data-step="1"]').classList.remove('active');
            document.querySelector('[data-step="2"]').classList.add('active');
        }

        async function completeSetup() {
            const password = document.getElementById('setupPassword').value;
            const timeout = document.getElementById('setupTimeout').value;
            const clipboard = document.getElementById('setupClipboard').value;
            
            try {
                // Generate salt
                const salt = generateSalt();
                
                // Derive key
                const key = await deriveKey(password, salt);
                
                // Store in state
                AppState.masterKey = key;
                AppState.salt = salt;
                AppState.entries = [];
                AppState.settings = {
                    autoLockTimeout: parseInt(timeout),
                    clipboardClear: parseInt(clipboard),
                    theme: document.documentElement.getAttribute('data-theme') || 'light'
                };
                AppState.isUnlocked = true;
                AppState.hasVault = true;
                
                // Save vault
                await saveVault();
                
                // Clear setup form
                document.getElementById('setupPassword').value = '';
                document.getElementById('setupPasswordConfirm').value = '';
                
                // Hide wizard, show app
                document.getElementById('setupWizard').classList.add('hidden');
                showApp();
                
                showToast('success', 'Vault Created', 'Your secure vault is ready to use');
                
            } catch (error) {
                console.error('Setup error:', error);
                document.getElementById('setupError2').textContent = 'Failed to create vault';
            }
        }

        function checkSetupPasswordStrength() {
            const password = document.getElementById('setupPassword').value;
            const strength = calculatePasswordStrength(password);
            
            const bars = ['strengthBar1', 'strengthBar2', 'strengthBar3', 'strengthBar4'];
            const strengthText = document.getElementById('strengthText');
            
            // Reset bars
            bars.forEach(id => {
                document.getElementById(id).className = 'strength-bar';
            });
            
            if (password.length === 0) {
                strengthText.textContent = '';
                return;
            }
            
            const levels = ['weak', 'fair', 'good', 'strong'];
            const messages = ['Weak', 'Fair', 'Good', 'Strong'];
            const colors = ['var(--danger)', 'var(--warning)', 'var(--info)', 'var(--success)'];
            
            for (let i = 0; i < strength.level; i++) {
                document.getElementById(bars[i]).classList.add(levels[strength.level - 1]);
            }
            
            strengthText.textContent = messages[strength.level - 1];
            strengthText.style.color = colors[strength.level - 1];
        }

        function calculatePasswordStrength(password) {
            let score = 0;
            
            if (password.length >= 8) score++;
            if (password.length >= 12) score++;
            if (/[a-z]/.test(password) && /[A-Z]/.test(password)) score++;
            if (/\d/.test(password)) score++;
            if (/[^a-zA-Z0-9]/.test(password)) score++;
            if (password.length >= 16) score++;
            
            let level = 1;
            if (score >= 3) level = 2;
            if (score >= 4) level = 3;
            if (score >= 5) level = 4;
            
            return { score, level };
        }

        // ========================================
        // SHOW MAIN APP
        // ========================================
        
        function showApp() {
            document.getElementById('appContainer').classList.remove('hidden');
            
            // Apply settings
            applySettings();
            
            // Render entries
            renderEntries();
            
            // Update counts
            updateCounts();
            
            // Start auto-lock timer
            resetAutoLockTimer();
			// Check for search parameter (from bookmarklet)
checkSearchParam();
// Setup biometrics UI in settings
setupBiometricsUI();
        }

        function applySettings() {
            // Apply theme
            const theme = AppState.settings.theme || 'light';
            if (theme === 'system') {
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                document.documentElement.setAttribute('data-theme', prefersDark ? 'dark' : 'light');
            } else {
                document.documentElement.setAttribute('data-theme', theme);
            }
            updateThemeIcons();
            
            // Update settings modal values
            document.getElementById('settingsTimeout').value = AppState.settings.autoLockTimeout;
            document.getElementById('settingsClipboard').value = AppState.settings.clipboardClear;
            document.getElementById('settingsDarkMode').checked = 
                document.documentElement.getAttribute('data-theme') === 'dark';
        }

        // ========================================
        // AUTO-LOCK TIMER
        // ========================================
        
        function resetAutoLockTimer() {
            clearAutoLockTimer();
            
            const timeout = AppState.settings.autoLockTimeout;
            if (timeout > 0 && AppState.isUnlocked) {
                AppState.autoLockTimer = setTimeout(() => {
                    lockVault();
                    showToast('warning', 'Auto-Locked', 'Vault locked due to inactivity');
                }, timeout * 60 * 1000);
            }
        }

        function clearAutoLockTimer() {
            if (AppState.autoLockTimer) {
                clearTimeout(AppState.autoLockTimer);
                AppState.autoLockTimer = null;
            }
        }

        // ========================================
        // THEME FUNCTIONS
        // ========================================
        
        function loadThemePreference() {
            const stored = localStorage.getItem('securevault_theme');
            if (stored) {
                document.documentElement.setAttribute('data-theme', stored);
            } else {
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                document.documentElement.setAttribute('data-theme', prefersDark ? 'dark' : 'light');
            }
            updateThemeIcons();
        }

        function toggleTheme() {
            const current = document.documentElement.getAttribute('data-theme');
            const newTheme = current === 'dark' ? 'light' : 'dark';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('securevault_theme', newTheme);
            
            if (AppState.isUnlocked) {
                AppState.settings.theme = newTheme;
                saveVault();
            }
            
            updateThemeIcons();
            document.getElementById('settingsDarkMode').checked = newTheme === 'dark';
        }

        function toggleThemeFromSettings() {
            toggleTheme();
        }

        function updateThemeIcons() {
            const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
            document.getElementById('themeIconLight').classList.toggle('hidden', isDark);
            document.getElementById('themeIconDark').classList.toggle('hidden', !isDark);
        }

        // ========================================
        // PASSWORD VISIBILITY TOGGLE
        // ========================================
        
        function togglePasswordVisibility(inputId, button) {
            const input = document.getElementById(inputId);
            const eyeIcon = button.querySelector('.eye-icon');
            const eyeOffIcon = button.querySelector('.eye-off-icon');
            
            if (input.type === 'password') {
                input.type = 'text';
                eyeIcon.classList.add('hidden');
                eyeOffIcon.classList.remove('hidden');
            } else {
                input.type = 'password';
                eyeIcon.classList.remove('hidden');
                eyeOffIcon.classList.add('hidden');
            }
        }
// ========================================
// BIOMETRICS (WebAuthn)
// ========================================

const BIOMETRIC_CREDENTIAL_KEY = 'securevault_biometric_cred';
const BIOMETRIC_WRAPPED_KEY = 'securevault_biometric_key';

function isBiometricsAvailable() {
    return window.PublicKeyCredential !== undefined &&
           window.location.protocol === 'https:' ||
           window.location.hostname === 'localhost' ||
           window.location.hostname === '127.0.0.1';
}

async function isBiometricsSupported() {
    if (!isBiometricsAvailable()) return false;
    
    try {
        const available = await PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable();
        return available;
    } catch (e) {
        return false;
    }
}

function isBiometricsEnabled() {
    return localStorage.getItem(BIOMETRIC_CREDENTIAL_KEY) !== null &&
           localStorage.getItem(BIOMETRIC_WRAPPED_KEY) !== null;
}

async function setupBiometricsUI() {
    const settingItem = document.getElementById('biometricsSettingItem');
    const removeItem = document.getElementById('biometricsRemoveItem');
    const toggle = document.getElementById('settingsBiometrics');
    const desc = document.getElementById('biometricsDesc');
    const unlockBtn = document.getElementById('biometricUnlockBtn');
    
    const supported = await isBiometricsSupported();
    const enabled = isBiometricsEnabled();
    
    if (!supported) {
        settingItem.style.opacity = '0.5';
        toggle.disabled = true;
        desc.textContent = 'Not available (requires HTTPS and compatible device)';
        unlockBtn.classList.add('hidden');
        return;
    }
    
    toggle.checked = enabled;
    removeItem.classList.toggle('hidden', !enabled);
    
    if (enabled) {
        desc.textContent = 'Biometric unlock is enabled';
        unlockBtn.classList.remove('hidden');
    } else {
        desc.textContent = 'Use fingerprint or Windows Hello to unlock';
        unlockBtn.classList.add('hidden');
    }
}

async function toggleBiometrics() {
    const toggle = document.getElementById('settingsBiometrics');
    
    if (toggle.checked) {
        // Enable biometrics
        const success = await enableBiometrics();
        if (!success) {
            toggle.checked = false;
        }
    } else {
        // Show confirmation
        toggle.checked = true; // Revert, let removeBiometrics handle it
        showToast('info', 'Use Remove Button', 'Click "Remove" to disable biometrics');
    }
    
    setupBiometricsUI();
}

async function enableBiometrics() {
    // First verify master password
    const password = prompt('Enter your master password to enable biometrics:');
    if (!password) return false;
    
    try {
        // Verify password works
        const stored = loadStoredVault();
        if (!stored) {
            showToast('error', 'Error', 'No vault found');
            return false;
        }
        
        const salt = hexToArray(stored.salt);
        const key = await deriveKey(password, salt);
        const decrypted = await decryptData(stored.data, key);
        
        if (!decrypted) {
            showToast('error', 'Wrong Password', 'Could not verify master password');
            return false;
        }
        
        // Create WebAuthn credential
        const credential = await createBiometricCredential();
        if (!credential) {
            showToast('error', 'Biometrics Failed', 'Could not register biometric credential');
            return false;
        }
        
        // Store credential ID
        const credentialId = btoa(String.fromCharCode(...new Uint8Array(credential.rawId)));
        localStorage.setItem(BIOMETRIC_CREDENTIAL_KEY, credentialId);
        
        // Wrap and store the encryption key data
        // We store salt + password hint encrypted with a random key
        // The "security" comes from biometric verification, not the encryption here
        const wrapperKey = crypto.getRandomValues(new Uint8Array(32));
        const wrappedData = await wrapKeyForBiometrics(password, stored.salt, wrapperKey);
        
        // Store wrapper key and wrapped data
        localStorage.setItem(BIOMETRIC_WRAPPED_KEY, JSON.stringify({
            wrapper: btoa(String.fromCharCode(...wrapperKey)),
            data: wrappedData
        }));
        
        showToast('success', 'Biometrics Enabled', 'You can now unlock with fingerprint or Windows Hello');
        return true;
        
    } catch (error) {
        console.error('Biometrics setup error:', error);
        showToast('error', 'Setup Failed', error.message || 'Could not enable biometrics');
        return false;
    }
}

async function createBiometricCredential() {
    try {
        const userId = crypto.getRandomValues(new Uint8Array(16));
        
        const publicKeyOptions = {
            challenge: crypto.getRandomValues(new Uint8Array(32)),
            rp: {
                name: 'SecureVault',
                id: window.location.hostname
            },
            user: {
                id: userId,
                name: 'vault-user',
                displayName: 'SecureVault User'
            },
            pubKeyCredParams: [
                { alg: -7, type: 'public-key' },   // ES256
                { alg: -257, type: 'public-key' }  // RS256
            ],
            authenticatorSelection: {
                authenticatorAttachment: 'platform',
                userVerification: 'required',
                residentKey: 'discouraged'
            },
            timeout: 60000,
            attestation: 'none'
        };
        
        const credential = await navigator.credentials.create({
            publicKey: publicKeyOptions
        });
        
        return credential;
        
    } catch (error) {
        console.error('Credential creation error:', error);
        return null;
    }
}

async function wrapKeyForBiometrics(password, saltHex, wrapperKey) {
    const encoder = new TextEncoder();
    const data = JSON.stringify({ password, saltHex });
    const dataBuffer = encoder.encode(data);
    
    const key = await crypto.subtle.importKey(
        'raw',
        wrapperKey,
        { name: 'AES-GCM' },
        false,
        ['encrypt']
    );
    
    const iv = crypto.getRandomValues(new Uint8Array(12));
    const encrypted = await crypto.subtle.encrypt(
        { name: 'AES-GCM', iv },
        key,
        dataBuffer
    );
    
    const combined = new Uint8Array(iv.length + encrypted.byteLength);
    combined.set(iv);
    combined.set(new Uint8Array(encrypted), iv.length);
    
    return btoa(String.fromCharCode(...combined));
}

async function unwrapKeyFromBiometrics() {
    const stored = localStorage.getItem(BIOMETRIC_WRAPPED_KEY);
    if (!stored) return null;
    
    try {
        const { wrapper, data } = JSON.parse(stored);
        const wrapperKey = Uint8Array.from(atob(wrapper), c => c.charCodeAt(0));
        const combined = Uint8Array.from(atob(data), c => c.charCodeAt(0));
        
        const iv = combined.slice(0, 12);
        const encrypted = combined.slice(12);
        
        const key = await crypto.subtle.importKey(
            'raw',
            wrapperKey,
            { name: 'AES-GCM' },
            false,
            ['decrypt']
        );
        
        const decrypted = await crypto.subtle.decrypt(
            { name: 'AES-GCM', iv },
            key,
            encrypted
        );
        
        const decoder = new TextDecoder();
        const json = decoder.decode(decrypted);
        return JSON.parse(json);
        
    } catch (error) {
        console.error('Unwrap error:', error);
        return null;
    }
}

async function unlockWithBiometrics() {
    const credentialIdStored = localStorage.getItem(BIOMETRIC_CREDENTIAL_KEY);
    if (!credentialIdStored) {
        showToast('error', 'Not Configured', 'Biometrics not set up');
        return;
    }
    
    try {
        const credentialId = Uint8Array.from(atob(credentialIdStored), c => c.charCodeAt(0));
        
        const assertion = await navigator.credentials.get({
            publicKey: {
                challenge: crypto.getRandomValues(new Uint8Array(32)),
                rpId: window.location.hostname,
                allowCredentials: [{
                    id: credentialId,
                    type: 'public-key',
                    transports: ['internal']
                }],
                userVerification: 'required',
                timeout: 60000
            }
        });
        
        if (!assertion) {
            showToast('error', 'Verification Failed', 'Biometric verification was not completed');
            return;
        }
        
        // Biometric verified! Now unwrap the stored key
        const keyData = await unwrapKeyFromBiometrics();
        if (!keyData) {
            showToast('error', 'Key Error', 'Could not retrieve stored credentials');
            removeBiometrics();
            return;
        }
        
        // Use the stored password to unlock
        const { password, saltHex } = keyData;
        const stored = loadStoredVault();
        
        if (!stored) {
            showToast('error', 'Vault Error', 'No vault found');
            return;
        }
        
        const salt = hexToArray(saltHex);
        const key = await deriveKey(password, salt);
        const decrypted = await decryptData(stored.data, key);
        
        if (!decrypted) {
            showToast('error', 'Decrypt Failed', 'Stored credentials may be outdated');
            removeBiometrics();
            return;
        }
        
        // Success!
        AppState.masterKey = key;
        AppState.salt = salt;
        AppState.entries = decrypted.entries || [];
        AppState.settings = { ...AppState.settings, ...decrypted.settings };
        AppState.isUnlocked = true;
        
        hideLockScreen();
        showApp();
        
        showToast('success', 'Welcome Back', 'Unlocked with biometrics');
        
    } catch (error) {
        console.error('Biometric unlock error:', error);
        
        if (error.name === 'NotAllowedError') {
            showToast('warning', 'Cancelled', 'Biometric verification was cancelled');
        } else {
            showToast('error', 'Unlock Failed', error.message || 'Biometric verification failed');
        }
    }
}

function removeBiometrics() {
    if (!confirm('Remove biometric unlock? You will need to use your master password.')) {
        return;
    }
    
    localStorage.removeItem(BIOMETRIC_CREDENTIAL_KEY);
    localStorage.removeItem(BIOMETRIC_WRAPPED_KEY);
    
    document.getElementById('settingsBiometrics').checked = false;
    setupBiometricsUI();
    
    showToast('success', 'Biometrics Removed', 'Biometric unlock has been disabled');
}

async function checkBiometricsOnLoad() {
    const enabled = isBiometricsEnabled();
    const unlockBtn = document.getElementById('biometricUnlockBtn');
    
    if (enabled) {
        const supported = await isBiometricsSupported();
        if (supported) {
            unlockBtn.classList.remove('hidden');
        } else {
            unlockBtn.classList.add('hidden');
        }
    } else {
        unlockBtn.classList.add('hidden');
    }
}
        // Initialize on DOM ready
		// ========================================
// PWA SUPPORT
// ========================================

let deferredInstallPrompt = null;

function setupPwa() {
    // Create manifest dynamically
    const manifest = {
        name: 'SecureVault',
        short_name: 'Vault',
        description: 'Offline Password Manager',
        start_url: window.location.href.split('?')[0],
        display: 'standalone',
        background_color: '#0d0d14',
        theme_color: '#3469ab',
        icons: [
            {
                src: 'data:image/svg+xml,' + encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><rect fill="#3469ab" width="512" height="512" rx="100"/><rect x="128" y="200" width="256" height="200" rx="20" fill="none" stroke="white" stroke-width="30"/><path d="M180 200 V160 A76 76 0 0 1 332 160 V200" fill="none" stroke="white" stroke-width="30"/><circle cx="256" cy="300" r="25" fill="white"/></svg>'),
                sizes: '512x512',
                type: 'image/svg+xml',
                purpose: 'any maskable'
            }
        ]
    };
    
    const manifestBlob = new Blob([JSON.stringify(manifest)], { type: 'application/json' });
    const manifestUrl = URL.createObjectURL(manifestBlob);
    document.getElementById('manifestLink').href = manifestUrl;
    
    // Listen for install prompt
    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredInstallPrompt = e;
        document.getElementById('installPwaBtn').style.display = 'inline-flex';
        document.getElementById('pwaInstalledText').style.display = 'none';
    });
    
    // Check if already installed
    window.addEventListener('appinstalled', () => {
        deferredInstallPrompt = null;
        document.getElementById('installPwaBtn').style.display = 'none';
        document.getElementById('pwaInstalledText').style.display = 'inline';
        showToast('success', 'App Installed', 'SecureVault added to your device');
    });
    
    // Check standalone mode
    if (window.matchMedia('(display-mode: standalone)').matches) {
        document.getElementById('installPwaBtn').style.display = 'none';
        document.getElementById('pwaInstalledText').style.display = 'inline';
    }
}

async function installPwa() {
    if (!deferredInstallPrompt) {
        showToast('info', 'Install Manually', 'Use your browser menu to "Add to Home Screen"');
        return;
    }
    
    deferredInstallPrompt.prompt();
    const { outcome } = await deferredInstallPrompt.userChoice;
    
    if (outcome === 'accepted') {
        showToast('success', 'Installing...', 'SecureVault is being added');
    }
    
    deferredInstallPrompt = null;
}

// ========================================
// BOOKMARKLET GENERATOR
// ========================================

function setupBookmarklet() {
    // Try to get saved URL or use current location
    const savedUrl = localStorage.getItem('securevault_url');
    const input = document.getElementById('vaultUrl');
    
    if (savedUrl) {
        input.value = savedUrl;
    } else if (window.location.protocol !== 'file:') {
        input.value = window.location.href.split('?')[0];
    }
    
    updateBookmarklet();
}

function updateBookmarklet() {
    const input = document.getElementById('vaultUrl');
    const url = input.value.trim() || window.location.href.split('?')[0];
    const bookmarkletLink = document.getElementById('vaultBookmarklet');
    
    // Save for later
    if (input.value.trim()) {
        localStorage.setItem('securevault_url', url);
    }
    
    // Create bookmarklet code
    // When clicked: gets current domain, opens vault with search param
    const code = `javascript:(function(){
        var domain = window.location.hostname.replace('www.','');
        var vaultUrl = '${url}';
        var searchParam = '?search=' + encodeURIComponent(domain);
        window.open(vaultUrl + searchParam, 'SecureVault', 'width=500,height=700,menubar=no,toolbar=no');
    })();`;
    
    bookmarkletLink.href = code.replace(/\s+/g, ' ');
}

function copyBookmarklet() {
    const bookmarkletLink = document.getElementById('vaultBookmarklet');
    copyToClipboard(bookmarkletLink.href, 'Bookmarklet code');
}

function checkSearchParam() {
    const params = new URLSearchParams(window.location.search);
    const searchQuery = params.get('search');
    
    if (searchQuery && AppState.isUnlocked) {
        document.getElementById('searchInput').value = searchQuery;
        AppState.searchQuery = searchQuery;
        document.getElementById('searchClear').classList.add('visible');
        renderEntries();
    }
}
        document.addEventListener('DOMContentLoaded', init);
    	
        // ========================================
        // ENTRY CRUD OPERATIONS
        // ========================================
        
        function generateEntryId() {
            return 'entry_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        function openAddEntryModal() {
            // Reset form
            document.getElementById('entryForm').reset();
            document.getElementById('entryId').value = '';
            document.getElementById('entryModalTitle').textContent = 'Add New Entry';
            document.getElementById('generatorPanel').classList.add('hidden');
            
            // Show modal
            document.getElementById('entryModal').classList.add('active');
            document.getElementById('entryTitle').focus();
        }

        function openEditEntryModal(entryId) {
            const entry = AppState.entries.find(e => e.id === entryId);
            if (!entry) return;
            
            // Populate form
            document.getElementById('entryId').value = entry.id;
            document.getElementById('entryTitle').value = entry.title || '';
            document.getElementById('entryCategory').value = entry.category || 'other';
            document.getElementById('entryUsername').value = entry.username || '';
            document.getElementById('entryPassword').value = entry.password || '';
            document.getElementById('entryUrl').value = entry.url || '';
            document.getElementById('entryNotes').value = entry.notes || '';
            document.getElementById('entryFavorite').checked = entry.favorite || false;
            document.getElementById('entryVersion').value = entry.version || 1;
			document.getElementById('genLength').value = entry.passwordLength || 16;
document.getElementById('lengthValue').textContent = entry.passwordLength || 16;

            document.getElementById('entryModalTitle').textContent = 'Edit Entry';
            document.getElementById('generatorPanel').classList.add('hidden');
            
            // Show modal
            document.getElementById('entryModal').classList.add('active');
        }

        function closeEntryModal() {
            document.getElementById('entryModal').classList.remove('active');
            document.getElementById('entryForm').reset();
        }

        async function saveEntry() {
            const id = document.getElementById('entryId').value;
            const title = document.getElementById('entryTitle').value.trim();
            const password = document.getElementById('entryPassword').value;
            
            // Validation
            if (!title) {
                showToast('error', 'Validation Error', 'Title is required');
                document.getElementById('entryTitle').focus();
                return;
            }
            
            if (!password) {
                showToast('error', 'Validation Error', 'Password is required');
                document.getElementById('entryPassword').focus();
                return;
            }
            
            const entryData = {
    id: id || generateEntryId(),
    title: title,
    category: document.getElementById('entryCategory').value,
    username: document.getElementById('entryUsername').value.trim(),
    password: password,
    version: parseInt(document.getElementById('entryVersion').value) || 1,
	passwordLength: parseInt(document.getElementById('genLength').value) || 16,
    url: document.getElementById('entryUrl').value.trim(),
    notes: document.getElementById('entryNotes').value.trim(),
    favorite: document.getElementById('entryFavorite').checked,
                createdAt: id ? (AppState.entries.find(e => e.id === id)?.createdAt || new Date().toISOString()) : new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            
            if (id) {
                // Update existing
                const index = AppState.entries.findIndex(e => e.id === id);
                if (index !== -1) {
                    AppState.entries[index] = entryData;
                }
                showToast('success', 'Entry Updated', `"${title}" has been updated`);
            } else {
                // Add new
                AppState.entries.push(entryData);
                showToast('success', 'Entry Added', `"${title}" has been added`);
            }
            
            // Save and refresh
            await saveVault();
            renderEntries();
            updateCounts();
            closeEntryModal();
        }

        function confirmDeleteEntry() {
            const entry = AppState.entries.find(e => e.id === AppState.currentEntryId);
            if (!entry) return;
            
            document.getElementById('deleteEntryName').textContent = entry.title;
            document.getElementById('deleteModal').classList.add('active');
        }

        async function deleteEntry() {
            if (!AppState.currentEntryId) return;
            
            const entry = AppState.entries.find(e => e.id === AppState.currentEntryId);
            const title = entry ? entry.title : 'Entry';
            
            AppState.entries = AppState.entries.filter(e => e.id !== AppState.currentEntryId);
            
            await saveVault();
            renderEntries();
            updateCounts();
            
            closeDeleteModal();
            closeViewEntryModal();
            
            showToast('success', 'Entry Deleted', `"${title}" has been deleted`);
        }

        function closeDeleteModal() {
            document.getElementById('deleteModal').classList.remove('active');
        }

        // ========================================
        // VIEW ENTRY FUNCTIONS
        // ========================================
        
        let currentViewPassword = '';
        let isPasswordVisible = false;

        function viewEntry(entryId) {
            const entry = AppState.entries.find(e => e.id === entryId);
            if (!entry) return;
            
            AppState.currentEntryId = entryId;
            currentViewPassword = entry.password;
            isPasswordVisible = false;
            
            // Populate view
            const initials = getInitials(entry.title);
            document.getElementById('viewEntryIcon').textContent = initials;
            document.getElementById('viewEntryIcon').className = `entry-detail-icon entry-icon cat-${entry.category}`;
            document.getElementById('viewEntryTitle').textContent = entry.title;
            document.getElementById('viewEntryCategory').textContent = CATEGORIES[entry.category]?.name || 'Other';
            document.getElementById('viewEntryCategoryDot').style.background = CATEGORIES[entry.category]?.color || 'var(--cat-other)';
            
            // Username
            const usernameField = document.getElementById('viewUsernameField');
            if (entry.username) {
                document.getElementById('viewEntryUsername').textContent = entry.username;
                usernameField.classList.remove('hidden');
            } else {
                usernameField.classList.add('hidden');
            }
            
            // Password (masked)
            document.getElementById('viewEntryPassword').textContent = '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢';
            resetPasswordToggleIcon();
            
            // URL
            const urlField = document.getElementById('viewUrlField');
            if (entry.url) {
                document.getElementById('viewEntryUrl').textContent = entry.url;
                document.getElementById('viewEntryUrl').href = entry.url;
                urlField.classList.remove('hidden');
            } else {
                urlField.classList.add('hidden');
            }
            
            // Notes
            const notesField = document.getElementById('viewNotesField');
            if (entry.notes) {
                document.getElementById('viewEntryNotes').textContent = entry.notes;
                notesField.classList.remove('hidden');
            } else {
                notesField.classList.add('hidden');
            }
            
            // Modified date
            const date = new Date(entry.updatedAt || entry.createdAt);
            document.getElementById('viewEntryModified').textContent = date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            // Show modal
            document.getElementById('viewEntryModal').classList.add('active');
        }

        function closeViewEntryModal() {
            document.getElementById('viewEntryModal').classList.remove('active');
            currentViewPassword = '';
            isPasswordVisible = false;
        }

        function toggleViewPassword() {
            const passwordEl = document.getElementById('viewEntryPassword');
            const toggleBtn = document.getElementById('viewPasswordToggle');
            const eyeIcon = toggleBtn.querySelector('.eye-icon');
            const eyeOffIcon = toggleBtn.querySelector('.eye-off-icon');
            
            isPasswordVisible = !isPasswordVisible;
            
            if (isPasswordVisible) {
                passwordEl.textContent = currentViewPassword;
                eyeIcon.classList.add('hidden');
                eyeOffIcon.classList.remove('hidden');
            } else {
                passwordEl.textContent = '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢';
                eyeIcon.classList.remove('hidden');
                eyeOffIcon.classList.add('hidden');
            }
        }

        function resetPasswordToggleIcon() {
            const toggleBtn = document.getElementById('viewPasswordToggle');
            const eyeIcon = toggleBtn.querySelector('.eye-icon');
            const eyeOffIcon = toggleBtn.querySelector('.eye-off-icon');
            eyeIcon.classList.remove('hidden');
            eyeOffIcon.classList.add('hidden');
        }

        function editCurrentEntry() {
            if (!AppState.currentEntryId) return;
            closeViewEntryModal();
            openEditEntryModal(AppState.currentEntryId);
        }

        function copyEntryPassword() {
            if (currentViewPassword) {
                copyToClipboard(currentViewPassword, 'Password');
            }
        }
		async function regenerateEntryPassword() {
    const entry = AppState.entries.find(e => e.id === AppState.currentEntryId);
    if (!entry) return;
    
    const length = entry.passwordLength || entry.password?.length || 16;
    const regenerated = await generateDeterministicPassword(
        entry.title,
        entry.username,
        entry.category,
        entry.version || 1,
        length
    );
    
    if (regenerated === entry.password) {
        showToast('success', 'Password Verified', 'Regenerated password matches stored');
    } else {
        showToast('warning', 'Password Differs', 'Stored password was not generated deterministically');
    }
}


        function openEntryUrl() {
            const url = document.getElementById('viewEntryUrl').href;
            if (url) {
                window.open(url, '_blank', 'noopener,noreferrer');
            }
        }

        // ========================================
        // RENDERING FUNCTIONS
        // ========================================
        
        function renderEntries() {
            const grid = document.getElementById('entriesGrid');
            const emptyState = document.getElementById('emptyState');
            
            // Filter entries
            let filtered = [...AppState.entries];
            
            // Apply view filter
            if (AppState.currentView === 'favorites') {
                filtered = filtered.filter(e => e.favorite);
            }
            
            // Apply category filter
            if (AppState.currentCategory) {
                filtered = filtered.filter(e => e.category === AppState.currentCategory);
            }
            
            // Apply search
            if (AppState.searchQuery) {
                const query = AppState.searchQuery.toLowerCase();
                filtered = filtered.filter(e => 
                    e.title.toLowerCase().includes(query) ||
                    (e.username && e.username.toLowerCase().includes(query)) ||
                    (e.url && e.url.toLowerCase().includes(query)) ||
                    (e.notes && e.notes.toLowerCase().includes(query))
                );
            }
            
            // Sort entries
            filtered = sortEntries(filtered, AppState.sortBy);
            
            // Update count display
            const countText = filtered.length === 1 ? '1 password' : `${filtered.length} passwords`;
            document.getElementById('entriesCount').textContent = countText;
            
            // Show empty state or entries
            if (filtered.length === 0) {
                grid.innerHTML = '';
                emptyState.classList.remove('hidden');
                
                // Update empty state message
                if (AppState.searchQuery) {
                    document.getElementById('emptyStateTitle').textContent = 'No results found';
                    document.getElementById('emptyStateText').textContent = 'Try a different search term';
                } else if (AppState.currentView === 'favorites') {
                    document.getElementById('emptyStateTitle').textContent = 'No favorites yet';
                    document.getElementById('emptyStateText').textContent = 'Star your important passwords to find them here';
                } else if (AppState.currentCategory) {
                    document.getElementById('emptyStateTitle').textContent = 'No passwords in this category';
                    document.getElementById('emptyStateText').textContent = 'Add a new entry to get started';
                } else {
                    document.getElementById('emptyStateTitle').textContent = 'No passwords yet';
                    document.getElementById('emptyStateText').textContent = 'Add your first password to get started';
                }
            } else {
                emptyState.classList.add('hidden');
                grid.innerHTML = filtered.map(entry => createEntryCard(entry)).join('');
            }
        }

        function createEntryCard(entry) {
            const initials = getInitials(entry.title);
            const categoryInfo = CATEGORIES[entry.category] || CATEGORIES.other;
            
            return `
                <div class="entry-card" onclick="viewEntry('${entry.id}')">
                    <div class="entry-card-header">
                        <div class="entry-icon cat-${entry.category}">${initials}</div>
                        <div class="entry-info">
                            <div class="entry-title">${escapeHtml(entry.title)}</div>
                            <div class="entry-username">${escapeHtml(entry.username || 'No username')}</div>
                        </div>
                    </div>
                    <button class="entry-favorite ${entry.favorite ? 'active' : ''}" 
                            onclick="event.stopPropagation(); toggleFavorite('${entry.id}')"
                            title="${entry.favorite ? 'Remove from favorites' : 'Add to favorites'}">
                        <svg viewBox="0 0 24 24" fill="${entry.favorite ? 'currentColor' : 'none'}" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                        </svg>
                    </button>
                    <div class="entry-card-footer">
                        <div class="entry-category">
                            <span class="entry-category-dot" style="background: ${categoryInfo.color}"></span>
                            ${categoryInfo.name}
                        </div>
                        <div class="entry-actions">
                            <button class="entry-action-btn" onclick="event.stopPropagation(); copyPassword('${entry.id}')" title="Copy Password">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                </svg>
                            </button>
                            <button class="entry-action-btn" onclick="event.stopPropagation(); openEditEntryModal('${entry.id}')" title="Edit">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function getInitials(title) {
            if (!title) return '??';
            const words = title.trim().split(/\s+/);
            if (words.length >= 2) {
                return (words[0][0] + words[1][0]).toUpperCase();
            }
            return title.substring(0, 2).toUpperCase();
        }

        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function sortEntries(entries, sortBy) {
            const sorted = [...entries];
            
            switch (sortBy) {
                case 'name-asc':
                    sorted.sort((a, b) => a.title.localeCompare(b.title));
                    break;
                case 'name-desc':
                    sorted.sort((a, b) => b.title.localeCompare(a.title));
                    break;
                case 'date-new':
                    sorted.sort((a, b) => new Date(b.updatedAt || b.createdAt) - new Date(a.updatedAt || a.createdAt));
                    break;
                case 'date-old':
                    sorted.sort((a, b) => new Date(a.updatedAt || a.createdAt) - new Date(b.updatedAt || b.createdAt));
                    break;
                case 'category':
                    sorted.sort((a, b) => a.category.localeCompare(b.category));
                    break;
            }
            
            return sorted;
        }

        // ========================================
        // FILTER & SEARCH FUNCTIONS
        // ========================================
        
        function filterByView(view) {
            AppState.currentView = view;
            AppState.currentCategory = null;
            
            // Update UI
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-view="${view}"]`)?.classList.add('active');
            
            // Update title
            document.getElementById('viewTitle').textContent = view === 'favorites' ? 'Favorites' : 'All Items';
            
            renderEntries();
            closeSidebar();
        }

        function filterByCategory(category) {
            AppState.currentView = 'category';
            AppState.currentCategory = category;
            
            // Update UI
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-category="${category}"]`)?.classList.add('active');
            
            // Update title
            document.getElementById('viewTitle').textContent = CATEGORIES[category]?.name || 'Category';
            
            renderEntries();
            closeSidebar();
        }

        function handleSearch() {
            const query = document.getElementById('searchInput').value;
            AppState.searchQuery = query;
            
            // Show/hide clear button
            document.getElementById('searchClear').classList.toggle('visible', query.length > 0);
            
            renderEntries();
        }

        function clearSearch() {
            document.getElementById('searchInput').value = '';
            AppState.searchQuery = '';
            document.getElementById('searchClear').classList.remove('visible');
            renderEntries();
        }

        function handleSort() {
            AppState.sortBy = document.getElementById('sortSelect').value;
            renderEntries();
        }

        function updateCounts() {
            const entries = AppState.entries;
            
            document.getElementById('countAll').textContent = entries.length;
            document.getElementById('countFavorites').textContent = entries.filter(e => e.favorite).length;
            
            // Category counts
            Object.keys(CATEGORIES).forEach(cat => {
                const count = entries.filter(e => e.category === cat).length;
                const el = document.getElementById(`count${cat.charAt(0).toUpperCase() + cat.slice(1)}`);
                if (el) el.textContent = count;
            });
            
            // Settings total
            document.getElementById('settingsTotalEntries').textContent = 
                `${entries.length} password${entries.length !== 1 ? 's' : ''} stored`;
        }

        async function toggleFavorite(entryId) {
            const entry = AppState.entries.find(e => e.id === entryId);
            if (!entry) return;
            
            entry.favorite = !entry.favorite;
            entry.updatedAt = new Date().toISOString();
            
            await saveVault();
            renderEntries();
            updateCounts();
            
            showToast('success', entry.favorite ? 'Added to Favorites' : 'Removed from Favorites', entry.title);
        }

        // ========================================
        // PASSWORD GENERATOR
        // ========================================
        
        function toggleGeneratorPanel() {
            const panel = document.getElementById('generatorPanel');
            panel.classList.toggle('hidden');
            
            if (!panel.classList.contains('hidden')) {
                generatePassword();
            }
        }
async function generateDeterministicPassword(title, username, category, version, length) {
    // Get master password from current session key - we use a derived approach
    const ingredients = [
        'SecureVault',           // App identifier
        title || '',
        username || '',
        category || 'other',
        String(version || 1)
    ].join('|');
    
    // Create hash from ingredients using master key
    const encoder = new TextEncoder();
    const data = encoder.encode(ingredients);
    
    // Use SHA-256 to hash
    const hashBuffer = await crypto.subtle.digest('SHA-256', data);
    const hashArray = new Uint8Array(hashBuffer);
    
    // Convert to password characters
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*';
    let password = '';
    
    // Ensure first char is a letter
    password += chars[hashArray[0] % 52];
    
    // Fill rest of password
    for (let i = 1; i < length; i++) {
        const byte = hashArray[i % hashArray.length] ^ hashArray[(i + 7) % hashArray.length];
        password += chars[byte % chars.length];
    }
    
    // Ensure complexity (at least one of each type)
    const upper = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    const lower = 'abcdefghijklmnopqrstuvwxyz';
    const nums = '0123456789';
    const syms = '!@#$%^&*';
    
    if (!/[A-Z]/.test(password)) password = upper[hashArray[28] % 26] + password.slice(1);
    if (!/[a-z]/.test(password)) password = password.slice(0, 1) + lower[hashArray[29] % 26] + password.slice(2);
    if (!/[0-9]/.test(password)) password = password.slice(0, 2) + nums[hashArray[30] % 10] + password.slice(3);
    if (!/[!@#$%^&*]/.test(password)) password = password.slice(0, 3) + syms[hashArray[31] % 8] + password.slice(4);
    
    return password;
}
        async function generatePassword() {
    const length = parseInt(document.getElementById('genLength').value);
    const isDeterministic = document.getElementById('genModeDeterministic').checked;
    
    if (isDeterministic) {
        // Get ingredients from form
        const title = document.getElementById('entryTitle').value.trim();
        const username = document.getElementById('entryUsername').value.trim();
        const category = document.getElementById('entryCategory').value;
        const version = document.getElementById('entryVersion').value || '1';
        
        if (!title) {
            document.getElementById('generatedPassword').textContent = 'Enter a title first';
            return;
        }
        
        const password = await generateDeterministicPassword(title, username, category, version, length);
        document.getElementById('generatedPassword').textContent = password;
    } else {
        // Original random generation
        const useUppercase = document.getElementById('genUppercase').checked;
        const useLowercase = document.getElementById('genLowercase').checked;
        const useNumbers = document.getElementById('genNumbers').checked;
        const useSymbols = document.getElementById('genSymbols').checked;
        
        let chars = '';
        if (useUppercase) chars += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
        if (useLowercase) chars += 'abcdefghijklmnopqrstuvwxyz';
        if (useNumbers) chars += '0123456789';
        if (useSymbols) chars += '!@#$%^&*()_+-=[]{}|;:,.<>?';
        
        if (!chars) {
            document.getElementById('generatedPassword').textContent = 'Select at least one option';
            return;
        }
        
        const array = new Uint32Array(length);
crypto.getRandomValues(array);

let password = '';

// First character must be a letter
const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
password += letters[array[0] % letters.length];

// Fill rest from selected character set
for (let i = 1; i < length; i++) {
    password += chars[array[i] % chars.length];
}

document.getElementById('generatedPassword').textContent = password;
    }
}

        function updateLengthValue() {
            const value = document.getElementById('genLength').value;
            document.getElementById('lengthValue').textContent = value;
            generatePassword();
        }

        function useGeneratedPassword() {
            const password = document.getElementById('generatedPassword').textContent;
            if (password && password !== 'Click generate to create password' && password !== 'Select at least one option') {
                document.getElementById('entryPassword').value = password;
                document.getElementById('generatorPanel').classList.add('hidden');
                showToast('success', 'Password Applied', 'Generated password has been set');
            }
        }

        // ========================================
        // CLIPBOARD FUNCTIONS
        // ========================================
        
        function copyPassword(entryId) {
            const entry = AppState.entries.find(e => e.id === entryId);
            if (entry && entry.password) {
                copyToClipboard(entry.password, 'Password');
            }
        }

        async function copyToClipboard(text, label = 'Text') {
            try {
                await navigator.clipboard.writeText(text);
                showToast('success', `${label} Copied`, getClipboardMessage());
                startClipboardClearTimer();
            } catch (err) {
                // Fallback for older browsers
                const textarea = document.createElement('textarea');
                textarea.value = text;
                textarea.style.position = 'fixed';
                textarea.style.opacity = '0';
                document.body.appendChild(textarea);
                textarea.select();
                
                try {
                    document.execCommand('copy');
                    showToast('success', `${label} Copied`, getClipboardMessage());
                    startClipboardClearTimer();
                } catch (e) {
                    showToast('error', 'Copy Failed', 'Could not copy to clipboard');
                }
                
                document.body.removeChild(textarea);
            }
        }

        function getClipboardMessage() {
            const timeout = AppState.settings.clipboardClear;
            if (timeout > 0) {
                return `Clipboard will clear in ${timeout}s`;
            }
            return 'Copied successfully';
        }

        function startClipboardClearTimer() {
            clearClipboardTimer();
            
            const timeout = AppState.settings.clipboardClear;
            if (timeout > 0) {
                AppState.clipboardTimer = setTimeout(async () => {
                    try {
                        await navigator.clipboard.writeText('');
                        showToast('info', 'Clipboard Cleared', 'For your security');
                    } catch (e) {
                        // Silent fail
                    }
                }, timeout * 1000);
            }
        }

        function clearClipboardTimer() {
            if (AppState.clipboardTimer) {
                clearTimeout(AppState.clipboardTimer);
                AppState.clipboardTimer = null;
            }
        }

        // ========================================
        // IMPORT / EXPORT FUNCTIONS
        // ========================================
        
        async function exportVault() {
            if (!AppState.isUnlocked) {
                showToast('error', 'Vault Locked', 'Unlock the vault first');
                return;
            }
            
            try {
                const stored = localStorage.getItem(STORAGE_KEY);
                if (!stored) {
                    showToast('error', 'Export Failed', 'No vault data found');
                    return;
                }
                
                const exportData = {
                    ...JSON.parse(stored),
                    exportedAt: new Date().toISOString(),
                    appName: 'SecureVault',
                    appVersion: '1.0.0'
                };
                
                const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
                const filename = `vault-backup-${new Date().toISOString().split('T')[0]}.json`;
                
                // Try File System Access API first (Chrome)
                if ('showSaveFilePicker' in window) {
                    try {
                        const handle = await window.showSaveFilePicker({
                            suggestedName: filename,
                            types: [{
                                description: 'JSON Files',
                                accept: { 'application/json': ['.json'] }
                            }]
                        });
                        const writable = await handle.createWritable();
                        await writable.write(blob);
                        await writable.close();
                        showToast('success', 'Export Complete', 'Vault backup saved successfully');
                        return;
                    } catch (e) {
                        if (e.name === 'AbortError') return;
                    }
                }
                
                // Fallback: download link
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showToast('success', 'Export Complete', 'Vault backup downloaded');
                
            } catch (error) {
                console.error('Export error:', error);
                showToast('error', 'Export Failed', 'Could not export vault');
            }
        }

        function importVault() {
            document.getElementById('fileInput').click();
        }

        async function handleFileImport(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            try {
                const text = await file.text();
                const data = JSON.parse(text);
                
                // Validate structure
                if (!data.salt || !data.data) {
                    showToast('error', 'Invalid File', 'This is not a valid vault backup');
                    return;
                }
                
                // Store the imported data
                localStorage.setItem(STORAGE_KEY, JSON.stringify({
                    salt: data.salt,
                    data: data.data,
                    version: data.version || '1.0'
                }));
                
                AppState.hasVault = true;
                
                // Reset state and show lock screen
                AppState.isUnlocked = false;
                AppState.masterKey = null;
                AppState.entries = [];
                
                document.getElementById('setupWizard').classList.add('hidden');
                document.getElementById('appContainer').classList.add('hidden');
                showLockScreen();
                
                showToast('success', 'Import Complete', 'Enter your master password to unlock');
                
            } catch (error) {
                console.error('Import error:', error);
                showToast('error', 'Import Failed', 'Could not read vault file');
            }
            
            // Reset file input
            event.target.value = '';
        }

        // ========================================
        // SETTINGS FUNCTIONS
        // ========================================
        
        function openSettings() {
            document.getElementById('settingsModal').classList.add('active');
            closeSidebar();
        }

        function closeSettings() {
            document.getElementById('settingsModal').classList.remove('active');
        }

        async function updateSettings() {
            AppState.settings.autoLockTimeout = parseInt(document.getElementById('settingsTimeout').value);
            AppState.settings.clipboardClear = parseInt(document.getElementById('settingsClipboard').value);
            
            await saveVault();
            resetAutoLockTimer();
            
            showToast('success', 'Settings Saved', 'Your preferences have been updated');
        }

        function showChangePassword() {
            closeSettings();
            document.getElementById('currentPassword').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmNewPassword').value = '';
            document.getElementById('changePasswordError').textContent = '';
            
            // Reset strength bars
            ['newStrengthBar1', 'newStrengthBar2', 'newStrengthBar3', 'newStrengthBar4'].forEach(id => {
                document.getElementById(id).className = 'strength-bar';
            });
            
            document.getElementById('changePasswordModal').classList.add('active');
        }

        function closeChangePassword() {
            document.getElementById('changePasswordModal').classList.remove('active');
        }

        function checkNewPasswordStrength() {
            const password = document.getElementById('newPassword').value;
            const strength = calculatePasswordStrength(password);
            
            const bars = ['newStrengthBar1', 'newStrengthBar2', 'newStrengthBar3', 'newStrengthBar4'];
            const levels = ['weak', 'fair', 'good', 'strong'];
            
            bars.forEach(id => {
                document.getElementById(id).className = 'strength-bar';
            });
            
            if (password.length > 0) {
                for (let i = 0; i < strength.level; i++) {
                    document.getElementById(bars[i]).classList.add(levels[strength.level - 1]);
                }
            }
        }

        async function changePassword() {
            const currentPwd = document.getElementById('currentPassword').value;
            const newPwd = document.getElementById('newPassword').value;
            const confirmPwd = document.getElementById('confirmNewPassword').value;
            const errorEl = document.getElementById('changePasswordError');
            
            errorEl.textContent = '';
            
            // Validation
            if (!currentPwd || !newPwd || !confirmPwd) {
                errorEl.textContent = 'All fields are required';
                return;
            }
            
            if (newPwd.length < 8) {
                errorEl.textContent = 'New password must be at least 8 characters';
                return;
            }
            
            if (newPwd !== confirmPwd) {
                errorEl.textContent = 'New passwords do not match';
                return;
            }
            
            try {
                // Verify current password
                const stored = loadStoredVault();
                const currentSalt = hexToArray(stored.salt);
                const currentKey = await deriveKey(currentPwd, currentSalt);
                const decrypted = await decryptData(stored.data, currentKey);
                
                if (!decrypted) {
                    errorEl.textContent = 'Current password is incorrect';
                    return;
                }
                
                // Generate new salt and key
                const newSalt = generateSalt();
                const newKey = await deriveKey(newPwd, newSalt);
                
                // Update state
                AppState.salt = newSalt;
                AppState.masterKey = newKey;
                
                // Save with new encryption
                await saveVault();
                
                closeChangePassword();
                showToast('success', 'Password Changed', 'Your master password has been updated');
                // Remove biometrics since password changed
if (isBiometricsEnabled()) {
    localStorage.removeItem(BIOMETRIC_CREDENTIAL_KEY);
    localStorage.removeItem(BIOMETRIC_WRAPPED_KEY);
    showToast('info', 'Biometrics Reset', 'Please re-enable biometrics with new password');
}
				
            } catch (error) {
                console.error('Change password error:', error);
                errorEl.textContent = 'Failed to change password';
            }
        }

        function confirmDeleteAllData() {
            document.getElementById('deleteConfirmInput').value = '';
            document.getElementById('deleteAllModal').classList.add('active');
        }

        function closeDeleteAllModal() {
            document.getElementById('deleteAllModal').classList.remove('active');
        }

        function deleteAllData() {
            const confirm = document.getElementById('deleteConfirmInput').value;
            
            if (confirm !== 'DELETE') {
                showToast('error', 'Confirmation Required', 'Type DELETE to confirm');
                return;
            }
            
            // Clear everything
            localStorage.removeItem(STORAGE_KEY);
            localStorage.removeItem('securevault_theme');
            
            // Reset state
            AppState.masterKey = null;
            AppState.salt = null;
            AppState.entries = [];
            AppState.isUnlocked = false;
            AppState.hasVault = false;
            
            closeDeleteAllModal();
            closeSettings();
            document.getElementById('appContainer').classList.add('hidden');
            showSetupWizard();
            
            showToast('info', 'Data Deleted', 'All vault data has been removed');
        }

        // ========================================
        // SIDEBAR FUNCTIONS (Mobile)
        // ========================================
        
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            sidebar.classList.toggle('open');
            overlay.classList.toggle('active');
        }

        function closeSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            sidebar.classList.remove('open');
            overlay.classList.remove('active');
        }

        // ========================================
        // MODAL UTILITIES
        // ========================================
        
        function closeAllModals() {
            document.querySelectorAll('.modal-overlay').forEach(modal => {
                modal.classList.remove('active');
            });
        }

        // ========================================
        // TOAST NOTIFICATIONS
        // ========================================
        
        function showToast(type, title, message) {
            const container = document.getElementById('toastContainer');
            
            const icons = {
                success: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>',
                error: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>',
                warning: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>',
                info: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>'
            };
            
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.innerHTML = `
                <div class="toast-icon">${icons[type]}</div>
                <div class="toast-content">
                    <div class="toast-title">${title}</div>
                    <div class="toast-message">${message}</div>
                </div>
                <button class="toast-close" onclick="this.parentElement.remove()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            `;
            
            container.appendChild(toast);
            
            // Auto remove after 4 seconds
            setTimeout(() => {
                toast.classList.add('toast-exit');
                setTimeout(() => toast.remove(), 300);
            }, 4000);
        }
    </script>
</body>
</html>





